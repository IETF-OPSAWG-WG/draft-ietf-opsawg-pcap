<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>PCAP Next Generation (pcapng) Capture File Format</title>
<meta content="Michael Tuexen" name="author">
<meta content="Fulvio Risso" name="author">
<meta content="Jasper Bongertz" name="author">
<meta content="Gerald Combs" name="author">
<meta content="Guy Harris" name="author">
<meta content="Eelco Chaudron" name="author">
<meta content="Michael C. Richardson" name="author">
<meta content="
       This document describes a format to record captured packets to a
file. This format is extensible; Wireshark can currently read and write
it, and libpcap can currently read some pcapng files. 
    " name="description">
<meta content="xml2rfc 3.21.0" name="generator">
<meta content="draft-ietf-opsawg-pcapng-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 69.5.1
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-opsawg-pcapng.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">pcapng</td>
<td class="right">June 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tuexen, et al.</td>
<td class="center">Expires 19 December 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-opsawg-pcapng-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-06-17" class="published">17 June 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-12-19">19 December 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Tuexen, <span class="editor">Ed.</span>
</div>
<div class="org">Muenster Univ. of Appl. Sciences</div>
</div>
<div class="author">
      <div class="author-name">F. Risso</div>
<div class="org">Politecnico di Torino</div>
</div>
<div class="author">
      <div class="author-name">J. Bongertz</div>
<div class="org">Airbus DS CyberSecurity</div>
</div>
<div class="author">
      <div class="author-name">G. Combs</div>
<div class="org">Wireshark</div>
</div>
<div class="author">
      <div class="author-name">G. Harris</div>
</div>
<div class="author">
      <div class="author-name">E. Chaudron</div>
<div class="org">Red Hat</div>
</div>
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">Sandelman</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">PCAP Next Generation (pcapng) Capture File Format</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a format to record captured packets to a
file. This format is extensible; Wireshark can currently read and write
it, and libpcap can currently read some pcapng files.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-opsawg-pcapng/">https://datatracker.ietf.org/doc/draft-ietf-opsawg-pcapng/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        opsawg Working Group mailing list (<span><a href="mailto:opsawg@ietf.org">mailto:opsawg@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/opsawg/">https://mailarchive.ietf.org/arch/browse/opsawg/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/opsawg/">https://www.ietf.org/mailman/listinfo/opsawg/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/IETF-OPSAWG-WG/pcapng">https://github.com/IETF-OPSAWG-WG/pcapng</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 19 December 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-acronyms" class="internal xref">Acronyms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-general-file-structure" class="internal xref">General File Structure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-general-block-structure" class="internal xref">General Block Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-block-types" class="internal xref">Block Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-logical-block-hierarchy" class="internal xref">Logical Block Hierarchy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-physical-file-layout" class="internal xref">Physical File Layout</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-options" class="internal xref">Options</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="auto internal xref">3.5.1</a>.  <a href="#name-custom-options" class="internal xref">Custom Options</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-data-format" class="internal xref">Data format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="auto internal xref">3.6.1</a>.  <a href="#name-endianness" class="internal xref">Endianness</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="auto internal xref">3.6.2</a>.  <a href="#name-alignment" class="internal xref">Alignment</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.3">
                    <p id="section-toc.1-1.3.2.6.2.3.1"><a href="#section-3.6.3" class="auto internal xref">3.6.3</a>.  <a href="#name-strings" class="internal xref">Strings</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-block-definition" class="internal xref">Block Definition</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-section-header-block" class="internal xref">Section Header Block</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-interface-description-block" class="internal xref">Interface Description Block</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-enhanced-packet-block" class="internal xref">Enhanced Packet Block</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-enhanced-packet-block-flags" class="internal xref">Enhanced Packet Block Flags Word</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-simple-packet-block" class="internal xref">Simple Packet Block</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-name-resolution-block" class="internal xref">Name Resolution Block</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-interface-statistics-block" class="internal xref">Interface Statistics Block</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-decryption-secrets-block" class="internal xref">Decryption Secrets Block</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-custom-block" class="internal xref">Custom Block</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-vendor-specific-custom-exte" class="internal xref">Vendor-Specific Custom Extensions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-supported-use-cases" class="internal xref">Supported Use-Cases</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-controlling-copy-behavior" class="internal xref">Controlling Copy Behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-strings-vs-octets" class="internal xref">Strings vs. Octets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-endianness-issues" class="internal xref">Endianness Issues</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-recommended-file-name-exten" class="internal xref">Recommended File Name Extension: .pcapng</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-conclusions" class="internal xref">Conclusions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-implementations" class="internal xref">Implementations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-standardized-block-type-cod" class="internal xref">Standardized Block Type Codes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-packet-block-obsolete" class="internal xref">Packet Block (obsolete!)</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The problem of exchanging packet traces becomes more and more
critical every day; unfortunately, no standard solutions exist for
this task right now. One of the most accepted packet interchange
formats is the one defined by libpcap, which is rather old and is
lacking in functionality for more modern applications particularly
from the extensibility point of view.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document proposes a new format for recording packet traces. The
following goals are being pursued:<a href="#section-1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1-3">
        <dt id="section-1-3.1">Extensibility:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.2">
          <p id="section-1-3.2.1">It should be possible to add new standard capabilities to the file
format over time, and third parties should be able to enrich the
information embedded in the file with proprietary extensions, with
tools unaware of newer extensions being able to ignore them.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.3">Portability:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.4">
          <p id="section-1-3.4.1">A capture trace must contain all the information needed to read data
independently from network, hardware and operating system of the
machine that made the capture.<a href="#section-1-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.5">Merge/Append data:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.6">
          <p id="section-1-3.6.1">It should be possible to add data at the end of a given file, and
the resulting file must still be readable.<a href="#section-1-3.6.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="acronyms">
<section id="section-2.1">
        <h3 id="name-acronyms">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-acronyms" class="section-name selfRef">Acronyms</a>
        </h3>
<p id="section-2.1-1">The following acronyms are used throughout this document:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-2">
          <dt id="section-2.1-2.1">SHB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">Section Header Block<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.3">IDB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">Interface Description Block<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.5">ISB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.6">
            <p id="section-2.1-2.6.1">Interface Statistics Block<a href="#section-2.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.7">EPB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.8">
            <p id="section-2.1-2.8.1">Enhanced Packet Block<a href="#section-2.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.9">SPB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.10">
            <p id="section-2.1-2.10.1">Simple Packet Block<a href="#section-2.1-2.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.11">NRB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.12">
            <p id="section-2.1-2.12.1">Name Resolution Block<a href="#section-2.1-2.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.13">CB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.14">
            <p id="section-2.1-2.14.1">Custom Block<a href="#section-2.1-2.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="general-file-structure">
<section id="section-3">
      <h2 id="name-general-file-structure">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-general-file-structure" class="section-name selfRef">General File Structure</a>
      </h2>
<div id="section_block">
<section id="section-3.1">
        <h3 id="name-general-block-structure">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-general-block-structure" class="section-name selfRef">General Block Structure</a>
        </h3>
<p id="section-3.1-1">A capture file is organized in blocks, that are appended one to
another to form the file. All the blocks share a common format, which
is shown in <a href="#formatblock" class="auto internal xref">Figure 1</a>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<span id="name-basic-block-structure"></span><div id="formatblock">
<figure id="figure-1">
          <div class="alignCenter art-text artwork" id="section-3.1-2.1">
<pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 0 |                          Block Type                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 /                          Block Body                           /
   /              variable length, padded to 32 bits               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-basic-block-structure" class="selfRef">Basic block structure.</a>
          </figcaption></figure>
</div>
<p id="section-3.1-3">The fields have the following meaning:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.1">
            <p id="section-3.1-4.1.1">Block Type (32 bits): a unique unsigned value that
identifies the block. Values whose Most Significant Bit
(MSB) is equal to 1 are reserved for local use. They can be
used to make extensions to the file format to save private
data to the file. The list of currently defined types can
be found in <a href="#section_block_code_registry" class="auto internal xref">Section 10.1</a>.<a href="#section-3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.2">
            <p id="section-3.1-4.2.1">Block Total Length (32 bits): an unsigned value giving
the total size of this block, in octets. For instance, the
length of a block that does not have a body is 12 octets: 4
octets for the Block Type, 4 octets for the initial Block
Total Length and 4 octets for the trailing Block Total
Length. This value MUST be a multiple of 4.<a href="#section-3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.3">
            <p id="section-3.1-4.3.1">Block Body: content of the block.<a href="#section-3.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.4">
            <p id="section-3.1-4.4.1">Block Total Length: total size of this block, in octets. This
field is duplicated to permit backward file navigation.<a href="#section-3.1-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-5">This structure, shared among all blocks, makes it easy to process a
file and to skip unneeded or unknown blocks. Some blocks can contain
other blocks inside (nested blocks). Some of the blocks are mandatory,
i.e. a capture file is not valid if they are not present, other are
optional.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">The General Block Structure allows defining other blocks if needed.
A parser that does not understand them can simply ignore their
content.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="block-types">
<section id="section-3.2">
        <h3 id="name-block-types">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-block-types" class="section-name selfRef">Block Types</a>
        </h3>
<p id="section-3.2-1">The currently standardized Block Type codes are specified in <a href="#section_block_code_registry" class="auto internal xref">Section 10.1</a>; they have been grouped in the
following four categories:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">(1) Mandatory: The following block MUST appear at least once in each file:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.1">
            <p id="section-3.2-3.1.1"><span><a href="#section_shb" class="internal xref">Section Header Block</a> (<a href="#section_shb" class="auto internal xref">Section 4.1</a>)</span>: it defines the most important characteristics of the
capture file.<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-4">(2) Optional: The following blocks MAY appear in a file:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-5.1">
            <p id="section-3.2-5.1.1"><span><a href="#section_idb" class="internal xref">Interface Description Block</a> (<a href="#section_idb" class="auto internal xref">Section 4.2</a>)</span>:
it defines the most important characteristics of the interface(s)
used for capturing traffic. This block is required in certain
cases, as described later.<a href="#section-3.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-5.2">
            <p id="section-3.2-5.2.1"><span><a href="#section_epb" class="internal xref">Enhanced Packet Block</a> (<a href="#section_epb" class="auto internal xref">Section 4.3</a>)</span>: it
contains a single captured packet, or a portion of it. It
represents an evolution of the original, now obsolete, <span><a href="#appendix_pb" class="internal xref">Packet Block</a> (<a href="#appendix_pb" class="auto internal xref">Appendix A</a>)</span>. If this appears in a
file, an Interface Description Block is also required, before this
block.<a href="#section-3.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-5.3">
            <p id="section-3.2-5.3.1"><span><a href="#section_spb" class="internal xref">Simple Packet Block</a> (<a href="#section_spb" class="auto internal xref">Section 4.4</a>)</span>: it
contains a single captured packet, or a portion of it, with only a
minimal set of information about it. If this appears in a file, an
Interface Description Block is also required, before this
block.<a href="#section-3.2-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-5.4">
            <p id="section-3.2-5.4.1"><span><a href="#section_nrb" class="internal xref">Name Resolution Block</a> (<a href="#section_nrb" class="auto internal xref">Section 4.5</a>)</span>: it
defines the mapping from numeric addresses present in the packet
capture and the canonical name counterpart.<a href="#section-3.2-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-5.5">
            <p id="section-3.2-5.5.1"><span><a href="#section_isb" class="internal xref">Interface Statistics Block</a> (<a href="#section_isb" class="auto internal xref">Section 4.6</a>)</span>: it
defines how to store some statistical data (e.g. packet dropped,
etc) which can be useful to understand the conditions in which the
capture has been made. If this appears in a file, an Interface
Description Block is also required, before this block.<a href="#section-3.2-5.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-5.6">
            <p id="section-3.2-5.6.1"><span><a href="#section_custom_block" class="internal xref">Custom Block</a> (<a href="#section_custom_block" class="auto internal xref">Section 4.8</a>)</span>: it
contains vendor-specific data in a portable fashion.<a href="#section-3.2-5.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-6">(3) Obsolete: The following block SHOULD NOT appear in newly written
files (but is documented in the Appendix for reference):<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-7.1">
            <p id="section-3.2-7.1.1"><span><a href="#appendix_pb" class="internal xref">Packet Block</a> (<a href="#appendix_pb" class="auto internal xref">Appendix A</a>)</span>: it contains a
single captured packet, or a portion of it. It is OBSOLETE, and
superseded by the <span><a href="#section_epb" class="internal xref">Enhanced Packet Block</a> (<a href="#section_epb" class="auto internal xref">Section 4.3</a>)</span>.<a href="#section-3.2-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-8">(4) Experimental: The following blocks are considered interesting but
the authors believe that they deserve more in-depth discussion before
being defined:<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-9.1">
            <p id="section-3.2-9.1.1">Alternative Packet Blocks<a href="#section-3.2-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-9.2">
            <p id="section-3.2-9.2.1">Compression Block<a href="#section-3.2-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-9.3">
            <p id="section-3.2-9.3.1">Encryption Block<a href="#section-3.2-9.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-9.4">
            <p id="section-3.2-9.4.1">Fixed Length Block<a href="#section-3.2-9.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-9.5">
            <p id="section-3.2-9.5.1">Directory Block<a href="#section-3.2-9.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-9.6">
            <p id="section-3.2-9.6.1">Traffic Statistics and Monitoring Blocks<a href="#section-3.2-9.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-9.7">
            <p id="section-3.2-9.7.1">Event/Security Blocks<a href="#section-3.2-9.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-10">Requests for new standardized Block Type codes should be made by
creating a pull request to update this document as described in
<a href="#section_block_code_registry" class="auto internal xref">Section 10.1</a>.<a href="#section-3.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="logical-block-hierarchy">
<section id="section-3.3">
        <h3 id="name-logical-block-hierarchy">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-logical-block-hierarchy" class="section-name selfRef">Logical Block Hierarchy</a>
        </h3>
<p id="section-3.3-1">The blocks build a logical hierarchy as they refer to each other. <a href="#block-hierarchy" class="auto internal xref">Figure 2</a> shows the logical hierarchy of the
currently defined blocks in the form of a "tree view":<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<span id="name-logical-block-hierarchy-of-"></span><div id="block-hierarchy">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-3.3-2.1">
<pre>
Section Header
|
+- Interface Description
|  +- Simple Packet
|  +- Enhanced Packet
|  +- Interface Statistics
|
+- Name Resolution
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-logical-block-hierarchy-of-" class="selfRef">Logical Block Hierarchy of a pcapng File</a>
          </figcaption></figure>
</div>
<p id="section-3.3-3">For example: each captured packet refers to a specific capture
interface, the interface itself refers to a specific section.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="physical-file-layout">
<section id="section-3.4">
        <h3 id="name-physical-file-layout">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-physical-file-layout" class="section-name selfRef">Physical File Layout</a>
        </h3>
<p id="section-3.4-1">The file MUST begin with a Section Header Block. However, more than
one Section Header Block can be present in the capture file, each one
covering the data following it until the next one (or the end of
file). A Section includes the data delimited by two Section Header
Blocks (or by a Section Header Block and the end of the file),
including the first Section Header Block.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">In case an application cannot read a Section because of different
version number, it MUST skip everything until the next Section Header
Block. Note that, in order to properly skip the blocks until the next
section, all blocks MUST have the fields Type and Length at the
beginning. In order to properly skip blocks in the backward direction,
all blocks MUST have the Length repeated at the end of the block.
These are mandatory requirements that MUST be maintained in future
versions of the block format.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3"><a href="#fssample-SHB" class="auto internal xref">Figure 3</a> shows a typical file layout, with a
single Section Header that covers the whole file.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<span id="name-file-structure-example-typi"></span><div id="fssample-SHB">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-3.4-4.1">
<pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SHB v1.0  |                      Data                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-file-structure-example-typi" class="selfRef">File structure example: Typical layout with a single Section Header Block</a>
          </figcaption></figure>
</div>
<p id="section-3.4-5"><a href="#fssample-SHB3" class="auto internal xref">Figure 4</a> shows a file that contains three headers, and is normally the result
of file concatenation. An application that understands only version
1.0 of the file format skips the intermediate section and restart
processing the packets after the third Section Header.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<span id="name-file-structure-example-thre"></span><div id="fssample-SHB3">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-3.4-6.1">
<pre>
|--   1st Section   --|--   2nd Section   --|--  3rd Section  --|
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SHB v1.0  |  Data   | SHB V1.1  |  Data   | SHB V1.0  |  Data |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-file-structure-example-thre" class="selfRef">File structure example: three Section Header Blocks in a single file</a>
          </figcaption></figure>
</div>
<p id="section-3.4-7"><a href="#fssample-minimum" class="auto internal xref">Figure 5</a> shows a file comparable to a "classic libpcap" file - the minimum for
a useful capture file. It contains a single Section Header Block
(SHB), a single Interface Description Block (IDB) and a few Enhanced
Packet Blocks (EPB).<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<span id="name-file-structure-example-a-pc"></span><div id="fssample-minimum">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-3.4-8.1">
<pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SHB | IDB | EPB | EPB |    ...    | EPB |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-file-structure-example-a-pc" class="selfRef">File structure example: a pcapng file similar to a classical libpcap file</a>
          </figcaption></figure>
</div>
<p id="section-3.4-9"><a href="#fssample-full" class="auto internal xref">Figure 6</a> shows a complex example file. In addition to the minimum file above,
it contains packets captured from three interfaces, capturing on the
third of which begins after packets have arrived on other interfaces,
and also includes some Name Resolution Blocks (NRB) and an Interface
Statistics Block (ISB).<a href="#section-3.4-9" class="pilcrow">¶</a></p>
<span id="name-file-structure-example-comp"></span><div id="fssample-full">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-3.4-10.1">
<pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SHB | IDB | IDB | EPB | NRB |...| IDB | EPB | ISB | NRB | EPB |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-file-structure-example-comp" class="selfRef">File structure example: complex pcapng file</a>
          </figcaption></figure>
</div>
<p id="section-3.4-11">The last example should make it obvious that the block structure
makes the file format very flexible compared to the classical libpcap
format.<a href="#section-3.4-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_opt">
<section id="section-3.5">
        <h3 id="name-options">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-options" class="section-name selfRef">Options</a>
        </h3>
<p id="section-3.5-1">All the block bodies MAY embed optional fields.
Optional fields can be used to insert some information that may be
useful when reading data, but that is not really needed for packet
processing. Therefore, each tool can either read the content of the
optional fields (if any), or skip some of them or even all at
once.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">A block that may contain options must be structured so that
the number of octets of data in the Block Body that precede the
options can be determined from that data; that allows the
beginning of the options to be found.  That is true for all
standard blocks that support options; for Custom Blocks that
support options, the Custom Data must be structured in such a
fashion.  This means that the Block Length field (present in
the General Block Structure, see <a href="#section_block" class="auto internal xref">Section 3.1</a>) can be used to determine how
many octets of optional fields, if any, are present in the block.
That number can be used to determine whether the block has
optional fields (if it is zero, there are no optional fields),
to check, when processing optional fields, whether any optional
fields remain, and to skip all the optional fields at once.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">Options are a list of Type - Length - Value fields, each one
containing a single value:<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-4.1">
            <p id="section-3.5-4.1.1">Option Type (16 bits): an unsigned value that contains
the code that specifies the type of the current TLV record.
Option types whose Most Significant Bit is equal to one are
reserved for local use; therefore, there is no guarantee
that the code used is unique among all capture files
(generated by other applications), and is most certainly not
portable.  For cross-platform globally unique
vendor-specific extensions, the Custom Option MUST be used
instead, as defined in <a href="#section_custom_option" class="auto internal xref">Section 3.5.1</a>).<a href="#section-3.5-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-4.2">
            <p id="section-3.5-4.2.1">Option Length (16 bits): an unsigned value that contains
the actual length of the following 'Option Value' field
without the padding octets.<a href="#section-3.5-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-4.3">
            <p id="section-3.5-4.3.1">Option Value (variable length): the value of the given
option, padded to a 32-bit boundary. The actual length of
this field (i.e. without the padding octets) is specified
by the Option Length field.<a href="#section-3.5-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.5-5">Requests for new standardized option codes for a given block
should be made by creating a pull request to update this document
as described in <a href="#section_block_code_registry" class="auto internal xref">Section 10.1</a>.<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<p id="section-3.5-6">A given option may have a fixed length, in which case all
instances of that option have a length that is equal to the
specified fixed length, or a variable length, in which case
the option has a minimum length and all instances of that
option must have a length equal to or greater than the specified
minimum length. The length of fixed-length options, and the
minimum length of variable-length options, is specified in the
description of the option; if the minimum length of a
variable-length option is not specified, a zero-length option is
valid. Software that reads these files SHOULD report options
that have an invalid length as errors; the software MAY stop
processing the file if it sees an option that has invalid
length, or MAY ignore the option and continue processing it.
Software that writes these files MUST NOT write files with
options that have invalid lengths.<a href="#section-3.5-6" class="pilcrow">¶</a></p>
<p id="section-3.5-7">If an option's value is a string, the value is not necessarily
zero-terminated. Software that reads these files MUST NOT assume that
strings are zero-terminated, and MUST treat a zero-value octet as a
string terminator.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<p id="section-3.5-8">Some options may be repeated several times; for example, a
block can have multiple comments, and an Interface Description
Block can give multiple IPv4 or IPv6 addresses for the
interface if it has multiple IPv4 or IPv6 addresses assigned to
it.  Other options may appear at most once in a given block.<a href="#section-3.5-8" class="pilcrow">¶</a></p>
<p id="section-3.5-9">The option list is terminated by an option which uses the
special 'End of Option' code (opt_endofopt).  Code that
writes pcapng files MUST put an opt_endofopt option at the end
of an option list.  Code that reads pcapng files MUST NOT assume
an option list will have an opt_endofopt option at the end; it
MUST also check for the end of the block, and SHOULD treat
blocks where the option list has no opt_endofopt option as if
the option list had an opt_endofopt option at the end.<a href="#section-3.5-9" class="pilcrow">¶</a></p>
<p id="section-3.5-10">The format of the optional fields is shown in <a href="#formatopt" class="auto internal xref">Figure 7</a>.<a href="#section-3.5-10" class="pilcrow">¶</a></p>
<span id="name-options-format"></span><div id="formatopt">
<figure id="figure-7">
          <div class="alignCenter art-text artwork" id="section-3.5-11.1">
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Option Type              |         Option Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                       Option Value                            /
/              variable length, padded to 32 bits               /
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                                                               /
/                 . . . other options . . .                     /
/                                                               /
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Option Type == opt_endofopt |   Option Length == 0          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-options-format" class="selfRef">Options Format</a>
          </figcaption></figure>
</div>
<p id="section-3.5-12">The following codes can always be present in any optional field:<a href="#section-3.5-12" class="pilcrow">¶</a></p>
<span id="name-common-options"></span><div id="optionsall">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-common-options" class="selfRef">Common Options</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Multiple allowed?</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">opt_endofopt</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">opt_comment</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
              <td class="text-left" rowspan="1" colspan="1">yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">opt_custom</td>
              <td class="text-left" rowspan="1" colspan="1">2988/2989/19372/19373</td>
              <td class="text-left" rowspan="1" colspan="1">variable, minimum 4</td>
              <td class="text-left" rowspan="1" colspan="1">yes</td>
            </tr>
          </tbody>
        </table>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.5-14">
          <dt id="section-3.5-14.1">opt_endofopt:</dt>
          <dd style="margin-left: 4.0em" id="section-3.5-14.2">
            <p id="section-3.5-14.2.1">The
opt_endofopt option delimits the end of the optional fields. This
option MUST NOT be repeated within a given list of options.<a href="#section-3.5-14.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-3.5-15">
          <dt id="section-3.5-15.1">opt_comment:</dt>
          <dd style="margin-left: 4.0em" id="section-3.5-15.2">
            <p id="section-3.5-15.2.1">The
opt_comment option is a UTF-8 string containing human-readable
comment text that is associated to the current block. Line
separators SHOULD be a carriage-return + linefeed ('\r\n') or just
linefeed ('\n'); either form may appear and be considered a line
separator. The string is not zero-terminated.<a href="#section-3.5-15.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.5-16">Examples: "This packet is the beginning of all of our
problems", "Packets 17-23 showing a bogus TCP retransmission!\r\n
This is reported in bugzilla entry 1486.\nIt will be fixed in the
future.".<a href="#section-3.5-16" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.5-17">
          <dt id="section-3.5-17.1">opt_custom:</dt>
          <dd style="margin-left: 4.0em" id="section-3.5-17.2">
            <p id="section-3.5-17.2.1">This option is
described in detail in <a href="#section_custom_option" class="auto internal xref">Section 3.5.1</a>.<a href="#section-3.5-17.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<div id="section_custom_option">
<section id="section-3.5.1">
          <h4 id="name-custom-options">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-custom-options" class="section-name selfRef">Custom Options</a>
          </h4>
<p id="section-3.5.1-1">Customs Options are used for portable, vendor-specific data
related to the block they're in. A Custom Option can be in any block
type that can have options, can be repeated any number of times in a
block, and may come before or after other option types - except the
opt_endofopt option, which is always the last option. Different Custom
Options, of different type codes and/or different Private Enterprise
Numbers, may be used in the same pcapng file. See <a href="#section_vendor" class="auto internal xref">Section 5</a> for additional details.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<span id="name-custom-options-format"></span><div id="formatcustomopt">
<figure id="figure-8">
            <div class="alignCenter art-text artwork" id="section-3.5.1-2.1">
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Custom Option Type        |         Option Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                Private Enterprise Number (PEN)                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                        Custom Data                            /
/              variable length, padded to 32 bits               /
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-custom-options-format" class="selfRef">Custom Options Format</a>
            </figcaption></figure>
</div>
<p id="section-3.5.1-3">The Custom Option has the following fields:<a href="#section-3.5.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1-4.1">
              <p id="section-3.5.1-4.1.1">Custom Option Type: The type code number for the Custom Option, which
can be one of the following decimal numbers:<a href="#section-3.5.1-4.1.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.5.1-4.1.2">
                <dt id="section-3.5.1-4.1.2.1">2988:</dt>
                <dd style="margin-left: 4.0em" id="section-3.5.1-4.1.2.2">
                  <p id="section-3.5.1-4.1.2.2.1">This option type code
identifies a Custom Option containing a UTF-8 string in the
Custom Data portion.  The string is not zero-terminated.
  This Custom Option can be safely copied to a new file if
the pcapng file is manipulated by an application; otherwise
19372 should be used instead. See <a href="#section_vendor_copy" class="auto internal xref">Section 5.2</a> for details.<a href="#section-3.5.1-4.1.2.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-3.5.1-4.1.3">
                <dt id="section-3.5.1-4.1.3.1">2989:</dt>
                <dd style="margin-left: 4.0em" id="section-3.5.1-4.1.3.2">
                  <p id="section-3.5.1-4.1.3.2.1">This option type code
identifies a Custom Option containing binary octets in the
Custom Data portion. This Custom Option can be safely copied
to a new file if the pcapng file is manipulated by an
application; otherwise 19372 should be used instead. See <a href="#section_vendor_copy" class="auto internal xref">Section 5.2</a> for details.<a href="#section-3.5.1-4.1.3.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-3.5.1-4.1.4">
                <dt id="section-3.5.1-4.1.4.1">19372:</dt>
                <dd style="margin-left: 4.0em" id="section-3.5.1-4.1.4.2">
                  <p id="section-3.5.1-4.1.4.2.1">This option type code
identifies a Custom Option containing a UTF-8 string in the
Custom Data portion.  The string is not zero-terminated.
This Custom Option should not be copied to a new file if
the pcapng file is manipulated by an application. See <a href="#section_vendor_copy" class="auto internal xref">Section 5.2</a> for details.<a href="#section-3.5.1-4.1.4.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-3.5.1-4.1.5">
                <dt id="section-3.5.1-4.1.5.1">19373:</dt>
                <dd style="margin-left: 4.0em" id="section-3.5.1-4.1.5.2">
                  <p id="section-3.5.1-4.1.5.2.1">This option type code
identifies a Custom Option containing binary octets in the
Custom Data portion. This Custom Option should not be copied
to a new file if the pcapng file is manipulated by an
application. See <a href="#section_vendor_copy" class="auto internal xref">Section 5.2</a> for
details.<a href="#section-3.5.1-4.1.5.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</li>
            <li class="normal" id="section-3.5.1-4.2">
              <p id="section-3.5.1-4.2.1">Option Length: as described in <a href="#section_block" class="auto internal xref">Section 3.1</a>,
this contains the length of the option's value, which includes the
4-octet Private Enterprise Number and variable-length Custom Data
fields, without the padding octets.<a href="#section-3.5.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.5.1-4.3">
              <p id="section-3.5.1-4.3.1">Private Enterprise Number: An IANA-assigned Private Enterprise
Number identifying the organization which defined the Custom
Option. See <a href="#section_vendor_uses" class="auto internal xref">Section 5.1</a> for details. The
PEN MUST be encoded using the same endianness as the Section
Header Block it is within the scope of.<a href="#section-3.5.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.5.1-4.4">
              <p id="section-3.5.1-4.4.1">Custom Data: the custom data, padded to a 32-bit boundary.<a href="#section-3.5.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="data-format">
<section id="section-3.6">
        <h3 id="name-data-format">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-data-format" class="section-name selfRef">Data format</a>
        </h3>
<div id="endianness">
<section id="section-3.6.1">
          <h4 id="name-endianness">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-endianness" class="section-name selfRef">Endianness</a>
          </h4>
<p id="section-3.6.1-1">Data contained in each section will always be saved according to
the characteristics (little endian / big endian) of the capturing
machine. This refers to all the fields that are saved as numbers and
that span over two or more octets.<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<p id="section-3.6.1-2">The approach of having each section saved in the native format of
the generating host is more efficient because it avoids translation
of data when reading / writing on the host itself, which is the most
common case when generating/processing capture captures.<a href="#section-3.6.1-2" class="pilcrow">¶</a></p>
<p id="section-3.6.1-3">Please note: The endianness is indicated by the <span><a href="#section_shb" class="internal xref">Section Header Block</a> (<a href="#section_shb" class="auto internal xref">Section 4.1</a>)</span>. Since this block
can appear several times in a pcapng file, a single file can contain
both endianness variants.<a href="#section-3.6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="alignment">
<section id="section-3.6.2">
          <h4 id="name-alignment">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-alignment" class="section-name selfRef">Alignment</a>
          </h4>
<p id="section-3.6.2-1">All fields of this specification use proper alignment for 16-
and 32-bit values. This makes it easier and faster to read/write
file contents if using techniques like memory mapped files.<a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
<p id="section-3.6.2-2">The alignment octets (marked in this document e.g. with "padded to
32 bits") MUST be filled with zeroes.<a href="#section-3.6.2-2" class="pilcrow">¶</a></p>
<p id="section-3.6.2-3">Please note: 64-bit values are not aligned to 64-bit boundaries.
This is because the file is naturally aligned to 32-bit boundaries
only. Special care MUST be taken when reading and writing such
values. (Note also that some 64-bit values are represented as a
64-bit integer in the endianness of the machine that wrote the
file, and others are represented as 2 32-bit values, one
containing the upper 32 bits of the value and one containing
the lower 32 bits of the value, each written as 32-bit
integers in the endianness of the machine that wrote the file.
Neither of these formats guarantee 64-bit alignment.)<a href="#section-3.6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="strings">
<section id="section-3.6.3">
          <h4 id="name-strings">
<a href="#section-3.6.3" class="section-number selfRef">3.6.3. </a><a href="#name-strings" class="section-name selfRef">Strings</a>
          </h4>
<p id="section-3.6.3-1">If a string is specified as being encoded as UTF-8, software that reads
that string MUST NOT assume that the string's value is valid UTF-8.
Implementations MAY discard a string that are invalid UTF-8 or MAY repair the string by
replacing invalid octet sequences with valid sequences.
For example such using the sequence for a Unicode REPLACEMENT CHARACTER.
Implementations that write string fields MUST write only valid UTF-8 strings.<a href="#section-3.6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="section_block_definition">
<section id="section-4">
      <h2 id="name-block-definition">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-block-definition" class="section-name selfRef">Block Definition</a>
      </h2>
<p id="section-4-1">This section details the format of the blocks currently defined.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="section_shb">
<section id="section-4.1">
        <h3 id="name-section-header-block">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-section-header-block" class="section-name selfRef">Section Header Block</a>
        </h3>
<p id="section-4.1-1">The Section Header Block (SHB) is mandatory. It identifies the
beginning of a section of the capture file. The Section Header
Block does not contain data but it rather identifies a list of blocks
(interfaces, packets) that are logically correlated. Its format is
shown in <a href="#format_shb" class="auto internal xref">Figure 9</a>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<span id="name-section-header-block-format"></span><div id="format_shb">
<figure id="figure-9">
          <div class="alignCenter art-text artwork" id="section-4.1-2.1">
<pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 0 |                   Block Type = 0x0A0D0D0A                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |                      Byte-Order Magic                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |          Major Version        |         Minor Version         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
16 |                                                               |
   |                          Section Length                       |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
24 /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-section-header-block-format" class="selfRef">Section Header Block Format</a>
          </figcaption></figure>
</div>
<p id="section-4.1-3">The meaning of the fields is:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">
            <p id="section-4.1-4.1.1">Block Type: The block type of the Section Header Block is the
integer corresponding to the 4-char string "\n\r\r\n"
(0x0A0D0D0A). This particular value is used for 2 reasons:<a href="#section-4.1-4.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-4.1.2">
<li id="section-4.1-4.1.2.1">
                <p id="section-4.1-4.1.2.1.1">This number is used to detect if a file has been transferred
  via FTP or HTTP from a machine to another with an inappropriate
  ASCII conversion. In this case, the value of this field will
  differ from the standard one ("\n\r\r\n") and the reader can
  detect a possibly corrupted file.<a href="#section-4.1-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.1-4.1.2.2">
                <p id="section-4.1-4.1.2.2.1">This value is palindromic, so that the reader is able to
  recognize the Section Header Block regardless of the endianness
  of the section. The endianness is recognized by reading the
  Byte-Order Magic, which is located 8 octets after the Block Type.<a href="#section-4.1-4.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</li>
          <li class="normal" id="section-4.1-4.2">
            <p id="section-4.1-4.2.1">Block Total Length: total size of this block, as described in <a href="#section_block" class="auto internal xref">Section 3.1</a>.<a href="#section-4.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.3">
            <p id="section-4.1-4.3.1">Byte-Order Magic (32 bits): an unsigned magic number,
whose value is the hexadecimal number 0x1A2B3C4D. This
number can be used to distinguish sections that have been
saved on little-endian machines from the ones saved on
big-endian machines, and to heuristically identify pcapng
files.<a href="#section-4.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.4">
            <p id="section-4.1-4.4.1">Major Version (16 bits): an unsigned value, giving the
number of the current major version of the format. The
value for the current version of the format is 1.<a href="#section-4.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.5">
            <p id="section-4.1-4.5.1">Minor Version (16 bits): an unsigned value, giving the
number of the current minor version of the format. The
value for the current version of the format is 0.<a href="#section-4.1-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.6">
            <p id="section-4.1-4.6.1">Section Length (64 bits): a signed value specifying the
length in octets of the following section, excluding the
Section Header Block itself.  This field can be used to skip
the section, for faster navigation inside large files. If
the Section Length is -1 (0xFFFFFFFFFFFFFFFF), this means
that the size of the section is not specified, and the only
way to skip the section is to parse the blocks that it
contains. Please note that if this field is valid (i.e.
not negative), its value is always a multiple of 4, as all
the blocks are aligned to and padded to 32-bit (4 octet)
boundaries. Also, special care should be taken in accessing
this field: since the alignment of all the blocks in the
file is 32-bits, this field is not guaranteed to be aligned
to a 64-bit boundary.  This could be a problem on 64-bit
processors.<a href="#section-4.1-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.7">
            <p id="section-4.1-4.7.1">Options: optionally, a list of options (formatted according to
the rules defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>) can be present.<a href="#section-4.1-4.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-5">Writers of pcapng files MUST NOT write SHBs with a Major Version other
than 1 or a Minor Version other than 0.  If they do so, they will write
a file that many readers of pcapng files, such as programs using libpcap
to read pcapng files (including, but not limited to, tcpdump),
Wireshark, and possibly other programs not to be able to read their
files.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">Some pcapng file writers have used a minor version of 2, but the file
format did not change incompatibly (new block types were added); Readers
of pcapng files MUST treat a Minor Version of 2 as equivalent to a Minor
Version of 0 (and, if they also write a pcapng file based on the results
of reading one or more pcapng files, they MUST NOT, as per the previous
sentence, write an SHB with a Minor Version of 2, even if they read an
SHB with a Minor Version of 2).  As indicated above, using a minor
version number other than 0 when writing a section of a pcapng file will
produce a section that most existing software will not be able to read;
future versions of some of that software will be able to read sections
with a version of 1.2, but older copies of that software that are not
updated to the latest version will still not be able to read them.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">The Major Version would be changed only if a new version of this
specification, for a later major version of the file format, were
created.  Such a version would only be created if the format were to
change in such a way that code that reads the new format could not read
the old format (i.e., code to read both formats would have to check the
version number and use different code paths for the two formats) and
code that reads the old format could not read the new format.  An
incompatible change to the format of an existing block or an existing
option would be such a change; the addition of a new block or a new
option would not be such a change.  An example of such an incompatible
change would be the addition of an additional field to the Section
Header Block, following the Minor Version field and before the Snaplen
field; software expecting the new SHB format would not correctly read
the old SHB format, and software expecting the old SHB format would not
correctly read the new SHB format.  (Note that a change to the SHB must
leave the Block Type, Block Total Length, Byte-Order Magic, Major
Version, and Minor Version fields at the same offsets from the beginning
of the SHB and with the same lengths, must keep the value of the Block
Type the same, must keep the two possible values of the Byte-Order
Magic the same, depending on the block's byte order, so that the rest of
the SHB can be correctly interpreted.)<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">The Minor Version would be changed only if a new version of this
specification, for a later minor version of the file format, were
created.  Such a version would only be created if the format were to
change in such a way that code that reads the new format could read the
old format without checking the version number but code that reads the
old format could not read all files in the new format.  A
backward-compatible change to the format of an existing block or an
existing option would be such a change; the addition of a new block or
a new option would not be such a change.  An example of such a
backward-compatible but not forward-compatible change would be a change
to the Interface Description block (see below) to use the current
Reserved field to indicate the presence of additional fields before the
Options, with a zero value indicate no such fields are present.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">I.e., adding new block types or options would not require that either
the Major Version or the Minor Version be changed, as code that does not
know about the block type or option should just skip it; only if
skipping a block or option does not work should the minor version number
be changed.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">Aside from the options defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>, the
following options are valid within this block:<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<span id="name-section-header-block-option"></span><div id="options_shb">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-section-header-block-option" class="selfRef">Section Header Block Options</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Multiple allowed?</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">shb_hardware</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">shb_os</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">shb_userappl</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
          </tbody>
        </table>
</div>
<span class="break"></span><dl class="dlNewline" id="section-4.1-12">
          <dt id="section-4.1-12.1">shb_hardware:</dt>
          <dd style="margin-left: 4.0em" id="section-4.1-12.2">
            <p id="section-4.1-12.2.1">The
shb_hardware option is a UTF-8 string containing the description
of the hardware used to create this section. The string is
not zero-terminated.<a href="#section-4.1-12.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-13">Examples: "x86 Personal Computer", "Sun Sparc Workstation".<a href="#section-4.1-13" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.1-14">
          <dt id="section-4.1-14.1">shb_os:</dt>
          <dd style="margin-left: 4.0em" id="section-4.1-14.2">
            <p id="section-4.1-14.2.1">The shb_os option
is a UTF-8 string containing the name of the operating system used
to create this section. The string is not zero-terminated.<a href="#section-4.1-14.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-15">Examples: "Windows XP SP2", "openSUSE 10.2".<a href="#section-4.1-15" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.1-16">
          <dt id="section-4.1-16.1">shb_userappl:</dt>
          <dd style="margin-left: 4.0em" id="section-4.1-16.2">
            <p id="section-4.1-16.2.1">The
shb_userappl option is a UTF-8 string containing the name of the
application used to create this section. The string is not
zero-terminated.<a href="#section-4.1-16.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-17">Examples: "dumpcap V0.99.7".<a href="#section-4.1-17" class="pilcrow">¶</a></p>
<p id="section-4.1-18">[Open issue: does a program which re-writes a capture file change
the original hardware/os/application info?]<a href="#section-4.1-18" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_idb">
<section id="section-4.2">
        <h3 id="name-interface-description-block">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-interface-description-block" class="section-name selfRef">Interface Description Block</a>
        </h3>
<p id="section-4.2-1">An Interface Description Block (IDB) is the container for
information describing an interface on which packet data is
captured.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Tools that write / read the capture file associate an incrementing
unsigned 32-bit number (starting from '0') to each Interface
Definition Block, called the Interface ID for the interface in
question. This number is unique within each Section and
identifies the interface to which the IDB refers; it is only
unique inside the current section, so, two Sections can have
different interfaces identified by the same Interface ID values.
This unique identifier is referenced by other blocks, such as
Enhanced Packet Blocks and Interface Statistic Blocks, to
indicate the interface to which the block refers (such the
interface that was used to capture the packet that an Enhanced
Packet Block contains or to which the statistics in an Interface
Statistic Block refer).<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Within a section, there must be an Interface Description Block for each
interface to which another block within that section refers.  Blocks
such as an Enhanced Packet Block or an Interface Statistics Block
contain an Interface ID value referring to a particular interface, and a
Simple Packet Block implicitly refers to an interface with an Interface
ID of 0.  If the file does not contain any blocks that use an Interface
ID, then the file does not need to have any IDBs.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">There is no requirement that all Interface Description Blocks occur
within a section before all blocks of other types, as long as the
Interface Description Block for an interface occurs before any block
that refers to that interface.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">An Interface Description Block is valid only inside the section
to which it belongs. The structure of an Interface Description Block is
shown in <a href="#format_idb" class="auto internal xref">Figure 10</a>.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<span id="name-interface-description-block-"></span><div id="format_idb">
<figure id="figure-10">
          <div class="alignCenter art-text artwork" id="section-4.2-6.1">
<pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 0 |                    Block Type = 0x00000001                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |           LinkType            |           Reserved            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |                            SnapLen                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
16 /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-interface-description-block-" class="selfRef">Interface Description Block Format</a>
          </figcaption></figure>
</div>
<p id="section-4.2-7">The meaning of the fields is:<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-8.1">
            <p id="section-4.2-8.1.1">Block Type: The block type of the Interface Description Block
is 1.<a href="#section-4.2-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-8.2">
            <p id="section-4.2-8.2.1">Block Total Length: total size of this block, as described in <a href="#section_block" class="auto internal xref">Section 3.1</a>.<a href="#section-4.2-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-8.3">
            <p id="section-4.2-8.3.1">LinkType (16 bits): an unsigned value that defines the
link layer type of this interface.  The list of Standardized
Link Layer Type codes is available in <span>[<a href="#I-D.richardson-opsawg-pcaplinktype" class="cite xref">I-D.richardson-opsawg-pcaplinktype</a>]</span>.<a href="#section-4.2-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-8.4">
            <p id="section-4.2-8.4.1">Reserved (16 bits): not used - MUST be filled with 0 by
pcapng file writers, and MUST be ignored by pcapng file
readers.<a href="#section-4.2-8.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-8.5">
            <p id="section-4.2-8.5.1">SnapLen (32 bits): an unsigned value indicating the
maximum number of octets captured from each packet.  The
portion of each packet that exceeds this value will not be
stored in the file. A value of zero indicates no limit.<a href="#section-4.2-8.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-8.6">
            <p id="section-4.2-8.6.1">Options: optionally, a list of options (formatted according to
the rules defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>) can be present.<a href="#section-4.2-8.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-9">In addition to the options defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>,
the following options are valid within this block:<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<span id="name-interface-description-block-o"></span><div id="optionsifb">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-interface-description-block-o" class="selfRef">Interface Description Block Options</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Multiple allowed?</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_name</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_description</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_IPv4addr</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_IPv6addr</td>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">17</td>
              <td class="text-left" rowspan="1" colspan="1">yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_MACaddr</td>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_EUIaddr</td>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_speed</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_tsresol</td>
              <td class="text-left" rowspan="1" colspan="1">9</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_tzone</td>
              <td class="text-left" rowspan="1" colspan="1">10</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_filter</td>
              <td class="text-left" rowspan="1" colspan="1">11</td>
              <td class="text-left" rowspan="1" colspan="1">variable, minimum 1</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_os</td>
              <td class="text-left" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_fcslen</td>
              <td class="text-left" rowspan="1" colspan="1">13</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_tsoffset</td>
              <td class="text-left" rowspan="1" colspan="1">14</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_hardware</td>
              <td class="text-left" rowspan="1" colspan="1">15</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_txspeed</td>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_rxspeed</td>
              <td class="text-left" rowspan="1" colspan="1">17</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">if_iana_tzname</td>
              <td class="text-left" rowspan="1" colspan="1">18</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
          </tbody>
        </table>
</div>
<span class="break"></span><dl class="dlNewline" id="section-4.2-11">
          <dt id="section-4.2-11.1">if_name:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-11.2">
            <p id="section-4.2-11.2.1">The if_name option
is a UTF-8 string containing the name of the device used to
capture data. The string is not zero-terminated.<a href="#section-4.2-11.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-12">Examples: "eth0", "\Device\NPF_{AD1CE675-96D0-47C5-ADD0-2504B9126B68}".<a href="#section-4.2-12" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-13">
          <dt id="section-4.2-13.1">if_description:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-13.2">
            <p id="section-4.2-13.2.1">The
if_description option is a UTF-8 string containing the description
of the device used to capture data. The string is not
zero-terminated.<a href="#section-4.2-13.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-14">Examples: "Wi-Fi", "Local Area Connection", "Wireless
Network Connection", "First Ethernet Interface".<a href="#section-4.2-14" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-15">
          <dt id="section-4.2-15.1">if_IPv4addr:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-15.2">
            <p id="section-4.2-15.2.1">The if_IPv4addr
option is an IPv4 network address and corresponding netmask for
the interface. The first four octets are the IP address, and
the next four octets are the netmask. This option can be repeated
multiple times within the same Interface Description Block when
multiple IPv4 addresses are assigned to the interface. Note that
the IP address and netmask are both treated as four octets, one
for each octet of the address or mask; they are not 32-bit
numbers, and thus the endianness of the SHB does not affect
this field's value.<a href="#section-4.2-15.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-16">Examples: '192 168 1 1 255 255 255 0'.<a href="#section-4.2-16" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-17">
          <dt id="section-4.2-17.1">if_IPv6addr:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-17.2">
            <p id="section-4.2-17.2.1">The
if_IPv6addr option is an IPv6 network address and corresponding
prefix length for the interface. The first 16 octets are the
IP address and the next octet is the prefix length. This option
can be repeated multiple times within the same Interface
Description Block when multiple IPv6 addresses are assigned to
the interface.<a href="#section-4.2-17.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-18">Example: 2001:0db8:85a3:08d3:1319:8a2e:0370:7344/64 is written
(in hex) as '20 01 0d b8 85 a3 08 d3 13 19 8a 2e 03 70 73 44
40'.<a href="#section-4.2-18" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-19">
          <dt id="section-4.2-19.1">if_MACaddr:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-19.2">
            <p id="section-4.2-19.2.1">The if_MACaddr
option is the Interface Hardware EUI-48 (MAC) address (48 bits), if
available.<a href="#section-4.2-19.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-20">Example: '00 01 02 03 04 05'.<a href="#section-4.2-20" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-21">
          <dt id="section-4.2-21.1">if_EUIaddr:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-21.2">
            <p id="section-4.2-21.2.1">The if_EUIaddr
option is the Interface Hardware EUI-64 address (64 bits), if
available.<a href="#section-4.2-21.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-22">Example: '02 34 56 FF FE 78 9A BC'.<a href="#section-4.2-22" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-23">
          <dt id="section-4.2-23.1">if_speed:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-23.2">
            <p id="section-4.2-23.2.1">The if_speed
option is a 64-bit unsigned value indicating the interface
speed, in bits per second.<a href="#section-4.2-23.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-24">Example: the 64-bit decimal number 100000000 for 100Mbps.<a href="#section-4.2-24" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-25">
          <dt id="section-4.2-25.1">if_tsresol:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-25.2">
            <p id="section-4.2-25.2.1">The if_tsresol
option identifies the resolution of timestamps. If the Most
Significant Bit is equal to zero, the remaining bits indicates the
resolution of the timestamp as a negative power of 10 (e.g. 6
means microsecond resolution, timestamps are the number of
microseconds since 1970-01-01 00:00:00 UTC). If the Most
Significant Bit is equal to one, the remaining bits indicates
the resolution as negative power of 2 (e.g. 10 means 1/1024
of second). If this option is not present, a resolution of
10^-6 is assumed (i.e. timestamps have the same resolution of
the standard 'libpcap' timestamps).<a href="#section-4.2-25.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-26">Example: '6'.<a href="#section-4.2-26" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-27">
          <dt id="section-4.2-27.1">if_tzone:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-27.2">
            <p id="section-4.2-27.2.1">The if_tzone
option identifies the time zone for GMT support.  This option has
never been specified in greater detail, and, unless it were to
identify something such as an <a href="https://www.iana.org/time-zones">IANA time zone database</a>
timezone, would be insufficient for converting between UTC and local
time.  Therefore, it SHOULD NOT be used; instead, the if_iana_tzname
option SHOULD be used if time zone information is to be specified.<a href="#section-4.2-27.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-28">Example: none<a href="#section-4.2-28" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-29">
          <dt id="section-4.2-29.1">if_filter:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-29.2">
            <p id="section-4.2-29.2.1">The if_filter
option identifies the filter (e.g. "capture only TCP traffic")
used to capture traffic. The first octet of the Option Data keeps a
code of the filter used (e.g. if this is a libpcap string, or BPF
bytecode, and more). More details about this format will be
presented in Appendix XXX (TODO). (TODO: better use different
options for different fields? e.g. if_filter_pcap, if_filter_bpf,
...)<a href="#section-4.2-29.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-30">Example: '00'"tcp port 23 and host 192.0.2.5".<a href="#section-4.2-30" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-31">
          <dt id="section-4.2-31.1">if_os:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-31.2">
            <p id="section-4.2-31.2.1">The if_os option is
a UTF-8 string containing the name of the operating system of the
machine in which this interface is installed. This can be
different from the same information that can be contained by the
Section Header Block (<a href="#section_shb" class="auto internal xref">Section 4.1</a>) because the
capture can have been done on a remote machine. The string is
not zero-terminated.<a href="#section-4.2-31.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-32">Examples: "Windows XP SP2", "openSUSE 10.2".<a href="#section-4.2-32" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-33">
          <dt id="section-4.2-33.1">if_fcslen:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-33.2">
            <p id="section-4.2-33.2.1">The if_fcslen
option is an 8-bit unsigned integer value that specifies the
length of the Frame Check Sequence (in bits) for this interface.
For link layers whose FCS length can change during time, the
Enhanced Packet Block epb_flags Option can be used in each
Enhanced Packet Block (see <a href="#section_epb_flags" class="auto internal xref">Section 4.3.1</a>).<a href="#section-4.2-33.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-34">Example: '4'.<a href="#section-4.2-34" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-35">
          <dt id="section-4.2-35.1">if_tsoffset:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-35.2">
            <p id="section-4.2-35.2.1">The
if_tsoffset option is a 64-bit signed integer value that
specifies an offset (in seconds) that must be added to the
timestamp of each packet to obtain the absolute timestamp of
a packet. If the option is not present, an offset of 0 is assumed
(i.e., timestamps in blocks are absolute timestamps).<a href="#section-4.2-35.2.1" class="pilcrow">¶</a></p>
<p id="section-4.2-35.2.2">This offset is not intended to be used as an offset between local
time and UTC; for this purpose, the if_iana_tzname option SHOULD be
used to specify a timezone.<a href="#section-4.2-35.2.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-36">Example: '1234'.<a href="#section-4.2-36" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-37">
          <dt id="section-4.2-37.1">if_hardware:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-37.2">
            <p id="section-4.2-37.2.1">The
if_hardware option is a UTF-8 string containing the description
of the interface hardware. The string is not zero-terminated.<a href="#section-4.2-37.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-38">Examples: "Broadcom NetXtreme", "Intel(R) PRO/1000 MT
Network Connection", "NETGEAR WNA1000Mv2 N150 Wireless USB
Micro Adapter".<a href="#section-4.2-38" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-39">
          <dt id="section-4.2-39.1">if_txspeed:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-39.2">
            <p id="section-4.2-39.2.1">The
if_txspeed option is a 64-bit unsigned value
indicating the interface transmit speed in bits per
second.<a href="#section-4.2-39.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-40">Example: the 64-bit decimal number 1024000 for
1024Kbps.<a href="#section-4.2-40" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-41">
          <dt id="section-4.2-41.1">if_rxspeed:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-41.2">
            <p id="section-4.2-41.2.1">The
if_rxspeed option is a 64-bit unsigned value
indicating the interface receive speed, in bits per
second.<a href="#section-4.2-41.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-42">Example: the 64-bit decimal number 8192000 for
8192Kbps.<a href="#section-4.2-42" class="pilcrow">¶</a></p>
<p id="section-4.2-43">If the interface transmit speed and receive speed are the
same, the if_speed option MUST be used and the if_txspeed and
if_rxspeed options MUST NOT be used.  If the transmit speed is
unknown, the if_speed and if_txspeed options MUST NOT be used;
if the receive speed is unknown, the if_speed and if_rxspeed
options MUST NOT be used.<a href="#section-4.2-43" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-44">
          <dt id="section-4.2-44.1">if_iana_tzname:</dt>
          <dd style="margin-left: 4.0em" id="section-4.2-44.2">
            <p id="section-4.2-44.2.1">The if_iana_tzname
option is a UTF-8 string that indicates the <a href="https://www.iana.org/time-zones">IANA time zone database</a>
timezone name for the IANA database timezone in which the interface
is located. The string is not zero-terminated.<a href="#section-4.2-44.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-45">Examples: "Africa/Nairobi", "Asia/Kolkata", "America/Sao_Paulo",
"Europe/Berlin".<a href="#section-4.2-45" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_epb">
<section id="section-4.3">
        <h3 id="name-enhanced-packet-block">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-enhanced-packet-block" class="section-name selfRef">Enhanced Packet Block</a>
        </h3>
<p id="section-4.3-1">An Enhanced Packet Block (EPB) is the standard container for
storing the packets coming from the network. The Enhanced Packet Block
is optional because packets can be stored either by means of this
block or the Simple Packet Block, which can be used to speed up
capture file generation; or a file may have no packets in it. The
format of an Enhanced Packet Block is shown in <a href="#format_epb" class="auto internal xref">Figure 11</a>.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">The Enhanced Packet Block is an improvement over the original, now
obsolete, <span><a href="#appendix_pb" class="internal xref">Packet Block</a> (<a href="#appendix_pb" class="auto internal xref">Appendix A</a>)</span>:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-3.1">
            <p id="section-4.3-3.1.1">it stores the Interface Identifier as a 32-bit integer value.
This is a requirement when a capture stores packets coming from a
large number of interfaces;<a href="#section-4.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-3.2">
            <p id="section-4.3-3.2.1">unlike the <span><a href="#appendix_pb" class="internal xref">Packet Block</a> (<a href="#appendix_pb" class="auto internal xref">Appendix A</a>)</span>, the
number of packets dropped by the capture system between this
packet and the previous one is not stored in the header, but
rather in an option of the block itself.<a href="#section-4.3-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-enhanced-packet-block-forma"></span><div id="format_epb">
<figure id="figure-11">
          <div class="alignCenter art-text artwork" id="section-4.3-4.1">
<pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 0 |                    Block Type = 0x00000006                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |                         Interface ID                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |                       (Upper 32 bits)                         |
   + - - - - - - - - - - - -  Timestamp  - - - - - - - - - - - - - +
16 |                       (Lower 32 bits)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
20 |                    Captured Packet Length                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
24 |                    Original Packet Length                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
28 /                                                               /
   /                          Packet Data                          /
   /              variable length, padded to 32 bits               /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-enhanced-packet-block-forma" class="selfRef">Enhanced Packet Block Format</a>
          </figcaption></figure>
</div>
<p id="section-4.3-5">The Enhanced Packet Block has the following fields:<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-6.1">
            <p id="section-4.3-6.1.1">Block Type: The block type of the Enhanced Packet Block is 6.<a href="#section-4.3-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-6.2">
            <p id="section-4.3-6.2.1">Block Total Length: total size of this block, as described in <a href="#section_block" class="auto internal xref">Section 3.1</a>.<a href="#section-4.3-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-6.3">
            <p id="section-4.3-6.3.1">Interface ID (32 bits): an unsigned value that specifies the
interface on which this packet was received or transmitted;
the correct interface will be the one whose Interface
Description Block (within the current Section of the file) is
identified by the same number (see <a href="#section_idb" class="auto internal xref">Section 4.2</a>)
of this field. The interface ID MUST be valid, which means that an
matching interface description block MUST exist.<a href="#section-4.3-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-6.4">
            <p id="section-4.3-6.4.1">Timestamp (64 bits): two 32-bit unsigned values, representing a single
64-bit unsigned integer, with the first value being the upper 32 bits
of that integer and the second value being the lower 32 bits of that
integer.  The 64-bit unsigned integer is a count of units of time.<a href="#section-4.3-6.4.1" class="pilcrow">¶</a></p>
<p id="section-4.3-6.4.2">
The length of a unit of time is specified by the 'if_tsresol' option
(see <a href="#format_idb" class="auto internal xref">Figure 10</a>) of the Interface Description Block specified by
the Interface ID.<a href="#section-4.3-6.4.2" class="pilcrow">¶</a></p>
<p id="section-4.3-6.4.3">
The 'if_tsoffset' option value, converted from seconds to units of
time, plus the timestamp value, represents the number of units of
time that have elapsed since 1970-01-01 00:00:00 UTC.<a href="#section-4.3-6.4.3" class="pilcrow">¶</a></p>
<p id="section-4.3-6.4.4">
Note that, unlike timestamps in the pcap file format, timestamps in
Enhanced Packet Blocks are not saved as two 32-bit values
that represent the seconds and microseconds that have
elapsed since 1970-01-01 00:00:00 UTC. Timestamps in Enhanced
Packet Blocks are saved as two 32-bit words that represent
the upper and lower 32 bits of a single 64-bit quantity.<a href="#section-4.3-6.4.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-6.5">
            <p id="section-4.3-6.5.1">Captured Packet Length (32 bits): an unsigned value that
indicates the number of octets captured from the packet
(i.e., the length of the Packet Data field). It will be the
minimum value among the Original Packet Length and the
snapshot length for the interface (SnapLen, defined in
<a href="#format_idb" class="auto internal xref">Figure 10</a>). The value of this field does not include the padding
octets added at the end of the Packet Data field to align the Packet
Data field to a 32-bit boundary.<a href="#section-4.3-6.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-6.6">
            <p id="section-4.3-6.6.1">Original Packet Length (32 bits): an unsigned value that indicates the
number of octets of packet data that would have been provided had the
packet not been truncated to the snapshot length for the interface or
to a length limit imposed by the capture mechanism.  If no truncation
was done, it will be the same as the Captured Packet Length, but it
will be different from the Captured Packet Length if the packet has
been truncated by the capture process. It SHOULD NOT be less than the
Captured Packet Length.<a href="#section-4.3-6.6.1" class="pilcrow">¶</a></p>
<p id="section-4.3-6.6.2">
A pcapng file writer MAY write an Original Packet Length that is less
than the Captured Packet Length if both the Captured Packet Length and
the Original Packet length came from a file in which a packet had an
Original Packet Length less than the Captured Packet Length;
otherwise, it MUST write an Original Packet Length that is greater
than or equal to the Captured Packet Length.<a href="#section-4.3-6.6.2" class="pilcrow">¶</a></p>
<p id="section-4.3-6.6.3">
A pcapng file reader MAY convert an Original Packet Length that is
less than the Captured Packet Length to a value that is greater than
or equal to the Captured Packet Length.<a href="#section-4.3-6.6.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-6.7">
            <p id="section-4.3-6.7.1">Packet Data: the data coming from the network, including
link-layer headers. The actual length of this field is
Captured Packet Length plus the padding to a 32-bit
boundary. The format of the link-layer headers depends on
the LinkType field specified in the Interface Description
Block (see <a href="#section_idb" class="auto internal xref">Section 4.2</a>) and it is specified
in the entry for that format in <span>[<a href="#I-D.richardson-opsawg-pcaplinktype" class="cite xref">I-D.richardson-opsawg-pcaplinktype</a>]</span>.<a href="#section-4.3-6.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-6.8">
            <p id="section-4.3-6.8.1">Options: optionally, a list of options (formatted according to
the rules defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>) can be present.<a href="#section-4.3-6.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-7">In addition to the options defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>,
the following options are valid within this block:<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<span id="name-enhanced-packet-block-optio"></span><div id="options_epb">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-enhanced-packet-block-optio" class="selfRef">Enhanced Packet Block Options</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Multiple allowed?</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">epb_flags</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">epb_hash</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">variable, minimum hash type-dependent</td>
              <td class="text-left" rowspan="1" colspan="1">yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">epb_dropcount</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">epb_packetid</td>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">epb_queue</td>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">epb_verdict</td>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">variable, minimum verdict type-dependent</td>
              <td class="text-left" rowspan="1" colspan="1">yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">epb_processid_threadid</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
          </tbody>
        </table>
</div>
<span class="break"></span><dl class="dlNewline" id="section-4.3-9">
          <dt id="section-4.3-9.1">epb_flags:</dt>
          <dd style="margin-left: 4.0em" id="section-4.3-9.2">
            <p id="section-4.3-9.2.1">The epb_flags
option is a 32-bit flags word containing link-layer information. A
complete specification of the allowed flags can be found in <a href="#section_epb_flags" class="auto internal xref">Section 4.3.1</a>.<a href="#section-4.3-9.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-10">Example: '0'.<a href="#section-4.3-10" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3-11">
          <dt id="section-4.3-11.1">epb_hash:</dt>
          <dd style="margin-left: 4.0em" id="section-4.3-11.2">
            <p id="section-4.3-11.2.1">The epb_hash
option contains a hash of the packet. The first octet specifies the
hashing algorithm, while the following octets contain the actual
hash, whose size depends on the hashing algorithm, and hence from
the value in the first octet. The hashing algorithm can be: 2s
complement (algorithm octet = 0, size = XXX), XOR (algorithm octet =
1, size=XXX), CRC32 (algorithm octet = 2, size = 4), MD-5
(algorithm octet = 3, size = 16), SHA-1 (algorithm octet = 4,
size = 20), Toeplitz (algorithm octet = 5, size = 4). The hash covers
only the packet, not the header added by the capture driver: this
gives the possibility to calculate it inside the network card. The
hash allows easier comparison/merging of different capture files,
and reliable data transfer between the data acquisition system and
the capture library.<a href="#section-4.3-11.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-12">Examples: '02 EC 1D 87 97', '03 45 6E C2 17 7C 10 1E 3C 2E 99 6E C2 9A 3D
50 8E'.<a href="#section-4.3-12" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3-13">
          <dt id="section-4.3-13.1">epb_dropcount:</dt>
          <dd style="margin-left: 4.0em" id="section-4.3-13.2">
            <p id="section-4.3-13.2.1">The
epb_dropcount option is a 64-bit unsigned integer value
specifying the number of packets lost (by the interface and
the operating system) between this packet and the preceding
one for the same interface or, for the first packet for an
interface, between this packet and the start of the capture
process.<a href="#section-4.3-13.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-14">Example: '0'.<a href="#section-4.3-14" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3-15">
          <dt id="section-4.3-15.1">epb_packetid:</dt>
          <dd style="margin-left: 4.0em" id="section-4.3-15.2">
            <p id="section-4.3-15.2.1">The
epb_packetid option is a 64-bit unsigned integer that uniquely
identifies the packet. If the same packet is seen by multiple
interfaces and there is a way for the capture application to
correlate them, the same epb_packetid value must be used. An
example could be a router that captures packets on all its
interfaces in both directions. When a packet hits interface A
on ingress, an EPB entry gets created, TTL gets decremented,
and right before it egresses on interface B another EPB entry
gets created in the trace file. In this case, two packets are
in the capture file, which are not identical but the
epb_packetid can be used to correlate them.<a href="#section-4.3-15.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-16">Example: '0'.<a href="#section-4.3-16" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3-17">
          <dt id="section-4.3-17.1">epb_queue:</dt>
          <dd style="margin-left: 4.0em" id="section-4.3-17.2">
            <p id="section-4.3-17.2.1">The epb_queue
option is a 32-bit unsigned integer that identifies on which queue
of the interface the specific packet was received.<a href="#section-4.3-17.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-18">Example: '0'.<a href="#section-4.3-18" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3-19">
          <dt id="section-4.3-19.1">epb_verdict:</dt>
          <dd style="margin-left: 4.0em" id="section-4.3-19.2">
            <p id="section-4.3-19.2.1">The epb_verdict
option stores a verdict of the packet. The verdict indicates what
would be done with the packet after processing it. For example, a
firewall could drop the packet. This verdict can be set by various
components, i.e. Hardware, Linux's eBPF TC or XDP framework, etc.
etc. The first octet specifies the verdict type, while the
following octets contain the actual verdict data, whose size
depends on the verdict type, and hence from the value in the first
octet. The verdict type can be: Hardware (type octet = 0, size =
variable), Linux_eBPF_TC (type octet = 1, size = 8 (64-bit unsigned
integer), value = TC_ACT_* as defined in the Linux <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/uapi/linux/pkt_cls.h">pck_cls.h</a> include), Linux_eBPF_XDP (type octet = 2, size = 8 (64-bit unsigned
integer), value = xdp_action as defined in the Linux <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/uapi/linux/bpf.h">pbf.h</a> include).<a href="#section-4.3-19.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-20">Example: '02 00 00 00 00 00 00 00 02' for Linux_eBPF_XDP with
verdict XDP_PASS.<a href="#section-4.3-20" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3-21">
          <dt id="section-4.3-21.1">epb_processid_threadid:</dt>
          <dd style="margin-left: 4.0em" id="section-4.3-21.2">
            <p id="section-4.3-21.2.1">The epb_processid_threadid
option stores the numeric process identifier and thread identifier
of the process which originated the packet as unsigned 32-bit
integers. The value 0 can be used for each if the concept of a
process or thread identifier does not make sense in context (e.g.
for inbound packets) or if the operating system capturing the
packets has no concept of processes or threads, respectively.<a href="#section-4.3-21.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-22">Example: '00 00 04 D2 00 00 00 00' for process 1234 and an unknown
thread.<a href="#section-4.3-22" class="pilcrow">¶</a></p>
<div id="section_epb_flags">
<section id="section-4.3.1">
          <h4 id="name-enhanced-packet-block-flags">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-enhanced-packet-block-flags" class="section-name selfRef">Enhanced Packet Block Flags Word</a>
          </h4>
<p id="section-4.3.1-1">The Enhanced Packet Block Flags Word is a 32-bit value that
contains link-layer information about the packet.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">The word is encoded as an unsigned 32-bit integer, using the
endianness of the Section Header Block scope it is in. In the
following table, the bits are numbered with 0 being the
least-significant bit and 31 being the most-significant bit of
the 32-bit unsigned integer. The meaning of the bits is the
following:<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<table class="center" id="table-5">
            <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Bit Number</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0-1</td>
                <td class="text-left" rowspan="1" colspan="1">Inbound / Outbound packet (00 = information not available, 01 = inbound, 10 = outbound)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2-4</td>
                <td class="text-left" rowspan="1" colspan="1">Reception type (000 = not specified, 001 = unicast, 010 = multicast, 011 = broadcast, 100 = promiscuous).</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">5-8</td>
                <td class="text-left" rowspan="1" colspan="1">FCS length, in octets (0000 if this information is not available). This value overrides the if_fcslen option of the Interface Description Block, and is used with those link layers (e.g. PPP) where the length of the FCS can change during time.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">9</td>
                <td class="text-left" rowspan="1" colspan="1">Checksum not ready, as a consequence of checksum offloading, e.g. a transmitted packet on an interface doing checksum offloading, so that the host networking stack doesn't compute and fill in the checksum before handing the packet either to the network adapter or the wraparound code path in the packet capture mechanism.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">10</td>
                <td class="text-left" rowspan="1" colspan="1">Checksum valid, the checksum has already been checked on the receive path before it was handed to the packet capture mechanism, so there's no need for the packet analyzer to check it.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">11</td>
                <td class="text-left" rowspan="1" colspan="1">TCP segmentation offloaded, this is either a received packet corresponding to several received link-layer packets, with reassembly having been done before the packet was handed to the packet capture mechanism, or a transmitted packet that will correspond to several link-layer packets after being fragmented, but that was wrapped around to the packet capture mechanism before the fragmentation occurred.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">12-15</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved (MUST be set to zero).</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">16-31</td>
                <td class="text-left" rowspan="1" colspan="1">link-layer-dependent errors (Bit 31 = symbol error, Bit 30 = preamble error, Bit 29 = Start Frame Delimiter error, Bit 28 = unaligned frame error, Bit 27 = wrong Inter Frame Gap error, Bit 26 = packet too short error, Bit 25 = packet too long error, Bit 24 = CRC error, other?? are 16 bits enough?).</td>
              </tr>
            </tbody>
          </table>
<p id="section-4.3.1-4">NOTE: in earlier versions of this specification, the bits
were specified as being numbered with 0 being the
most-significant bit and 31 being the least-significant bit
of the 32-bit unsigned integer, rather than with 0 being the
least-significant bit and 31 being the most-significant bit.
Several implementations number the bits with 0 being the
least-significant bit, and no known implementations number
them with 0 being the most-significant bit, so the
specification was changed to reflect that reality.<a href="#section-4.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="section_spb">
<section id="section-4.4">
        <h3 id="name-simple-packet-block">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-simple-packet-block" class="section-name selfRef">Simple Packet Block</a>
        </h3>
<p id="section-4.4-1">The Simple Packet Block (SPB) is a lightweight container for
storing the packets coming from the network. Its presence is
optional.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">A Simple Packet Block is similar to an Enhanced Packet Block (see <a href="#section_epb" class="auto internal xref">Section 4.3</a>), but it is smaller, simpler to process
and contains only a minimal set of information. This block is
preferred to the standard Enhanced Packet Block when performance or
space occupation are critical factors, such as in sustained traffic
capture applications. A capture file can contain both Enhanced Packet
Blocks and Simple Packet Blocks: for example, a capture tool could
switch from Enhanced Packet Blocks to Simple Packet Blocks when the
hardware resources become critical.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">The Simple Packet Block does not contain the Interface ID field.
Therefore, it MUST be assumed that all the Simple Packet Blocks have
been captured on the interface previously specified in the first
Interface Description Block.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4"><a href="#format_spb" class="auto internal xref">Figure 12</a> shows the format of the Simple Packet
Block.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<span id="name-simple-packet-block-format"></span><div id="format_spb">
<figure id="figure-12">
          <div class="alignCenter art-text artwork" id="section-4.4-5.1">
<pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 0 |                    Block Type = 0x00000003                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |                    Original Packet Length                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 /                                                               /
   /                          Packet Data                          /
   /              variable length, padded to 32 bits               /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-simple-packet-block-format" class="selfRef">Simple Packet Block Format</a>
          </figcaption></figure>
</div>
<p id="section-4.4-6">The Simple Packet Block has the following fields:<a href="#section-4.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-7.1">
            <p id="section-4.4-7.1.1">Block Type: The block type of the Simple Packet Block is 3.<a href="#section-4.4-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-7.2">
            <p id="section-4.4-7.2.1">Block Total Length: total size of this block, as described in <a href="#section_block" class="auto internal xref">Section 3.1</a>.<a href="#section-4.4-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-7.3">
            <p id="section-4.4-7.3.1">Original Packet Length (32 bits): an unsigned value
indicating the actual length of the packet when it was
transmitted on the network. It can be different from length
of the Packet Data field's length if the packet has been
truncated by the capture process, in which case the SnapLen
value in <a href="#section_idb" class="auto internal xref">Section 4.2</a> will be less than this
Original Packet Length value, and the SnapLen value MUST be
used to determine the size of the Packet Data field
length.<a href="#section-4.4-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-7.4">
            <p id="section-4.4-7.4.1">Packet Data: the data coming from the network, including
link-layer headers. The length of this field can be derived
from the field Block Total Length, present in the Block
Header, and it is the minimum value among the SnapLen
(present in the Interface Description Block) and the
Original Packet Length (present in this header). The format
of the data within this Packet Data field depends on the
LinkType field specified in the Interface Description Block
(see <a href="#section_idb" class="auto internal xref">Section 4.2</a>) and it is specified in
the entry for that format in <span>[<a href="#I-D.richardson-opsawg-pcaplinktype" class="cite xref">I-D.richardson-opsawg-pcaplinktype</a>]</span>.<a href="#section-4.4-7.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.4-8">The Simple Packet Block does not contain the timestamp because this
is often one of the most costly operations on PCs. Additionally, there
are applications that do not require it; e.g. an Intrusion Detection
System is interested in packets, not in their timestamp.<a href="#section-4.4-8" class="pilcrow">¶</a></p>
<p id="section-4.4-9">A Simple Packet Block cannot be present in a Section that has more
than one interface because of the impossibility to refer to the
correct one (it does not contain any Interface ID field).<a href="#section-4.4-9" class="pilcrow">¶</a></p>
<p id="section-4.4-10">The Simple Packet Block is very efficient in term of disk space: a
snapshot whose length is 100 octets requires only 16 octets of overhead,
which corresponds to an efficiency of more than 86%.<a href="#section-4.4-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_nrb">
<section id="section-4.5">
        <h3 id="name-name-resolution-block">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-name-resolution-block" class="section-name selfRef">Name Resolution Block</a>
        </h3>
<p id="section-4.5-1">The Name Resolution Block (NRB) is used to support the correlation
of numeric addresses (present in the captured packets) and their
corresponding canonical names and it is optional. Having the literal
names saved in the file prevents the need for performing name
resolution at a later time, when the association between names and
addresses may be different from the one in use at capture time.
Moreover, the NRB avoids the need for issuing a lot of DNS requests
every time the trace capture is opened, and also provides name
resolution when reading the capture with a machine not connected to
the network.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">A Name Resolution Block is often placed at the beginning of the
file, but no assumptions can be taken about its position. Multiple
NRBs can exist in a pcapng file, either due to memory constraints or
because additional name resolutions were performed by file processing
tools, like network analyzers.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">A Name Resolution Block need not contain any Records, except the
nrb_record_end Record which MUST be the last Record. The addresses and
names in NRB Records MAY be repeated multiple times; i.e., the same IP
address may resolve to multiple names, the same name may resolve to
the multiple IP addresses, and even the same address-to-name pair may
appear multiple times, in the same NRB or across NRBs.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">The format of the Name Resolution Block is shown in <a href="#format_nrb" class="auto internal xref">Figure 13</a>.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<span id="name-name-resolution-block-forma"></span><div id="format_nrb">
<figure id="figure-13">
          <div class="alignCenter art-text artwork" id="section-4.5-5.1">
<pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 0 |                    Block Type = 0x00000004                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |      Record Type              |      Record Value Length      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 /                       Record Value                            /
   /              variable length, padded to 32 bits               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   .                                                               .
   .                  . . . other records . . .                    .
   .                                                               .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Record Type = nrb_record_end |   Record Value Length = 0     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-name-resolution-block-forma" class="selfRef">Name Resolution Block Format</a>
          </figcaption></figure>
</div>
<p id="section-4.5-6">The Name Resolution Block has the following fields:<a href="#section-4.5-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-7.1">
            <p id="section-4.5-7.1.1">Block Type: The block type of the Name Resolution Block is 4.<a href="#section-4.5-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-7.2">
            <p id="section-4.5-7.2.1">Block Total Length: total size of this block, as described in <a href="#section_block" class="auto internal xref">Section 3.1</a>.<a href="#section-4.5-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.5-8">This is followed by zero or more Name Resolution Records (in the
TLV format), each of which contains an association between a network
address and a name. An nrb_record_end MUST be added after the last
Record, and MUST exist even if there are no other Records in the NRB.
There are currently three possible types of records:<a href="#section-4.5-8" class="pilcrow">¶</a></p>
<span id="name-name-resolution-block-recor"></span><div id="nrrecords">
<table class="center" id="table-6">
          <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-name-resolution-block-recor" class="selfRef">Name Resolution Block Records</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">nrb_record_end</td>
              <td class="text-left" rowspan="1" colspan="1">0x0000</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">nrb_record_ipv4</td>
              <td class="text-left" rowspan="1" colspan="1">0x0001</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">nrb_record_ipv6</td>
              <td class="text-left" rowspan="1" colspan="1">0x0002</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">nrb_record_eui48</td>
              <td class="text-left" rowspan="1" colspan="1">0x0003</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">nrb_record_eui64</td>
              <td class="text-left" rowspan="1" colspan="1">0x0004</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
            </tr>
          </tbody>
        </table>
</div>
<span class="break"></span><dl class="dlNewline" id="section-4.5-10">
          <dt id="section-4.5-10.1">nrb_record_end:</dt>
          <dd style="margin-left: 4.0em" id="section-4.5-10.2">
            <p id="section-4.5-10.2.1">The
nrb_record_end record delimits the end of name resolution
records. This record is needed to determine when the list of name
resolution records has ended and some options (if any) begin.<a href="#section-4.5-10.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-4.5-11">
          <dt id="section-4.5-11.1">nrb_record_ipv4:</dt>
          <dd style="margin-left: 4.0em" id="section-4.5-11.2">
            <p id="section-4.5-11.2.1">The
nrb_record_ipv4 record specifies an IPv4 address (contained in the
first 4 octets), followed by one or more zero-terminated UTF-8
strings containing the DNS entries for that address. The minimum
valid Record Length for this Record Type is thus 6: 4 for the IP
octets, 1 character, and a zero-value octet terminator. Note that
the IP address is treated as four octets, one for each octet of
the IP address; it is not a 32-bit word, and thus the endianness
of the SHB does not affect this field's value.<a href="#section-4.5-11.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-12">Example: '127 0 0 1'"localhost".<a href="#section-4.5-12" class="pilcrow">¶</a></p>
<p id="section-4.5-13">[Open issue: is an empty string (i.e., just a zero-value octet)
valid?]<a href="#section-4.5-13" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.5-14">
          <dt id="section-4.5-14.1">nrb_record_ipv6:</dt>
          <dd style="margin-left: 4.0em" id="section-4.5-14.2">
            <p id="section-4.5-14.2.1">The
nrb_record_ipv6 record specifies an IPv6 address (contained in the
first 16 octets), followed by one or more zero-terminated strings
containing the DNS entries for that address. The minimum valid
Record Length for this Record Type is thus 18: 16 for the IP
octets, 1 character, and a zero-value octet terminator.<a href="#section-4.5-14.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-15">Example: '20 01 0d b8 00 00 00 00 00 00 00 00 12 34 56
78'"somehost".<a href="#section-4.5-15" class="pilcrow">¶</a></p>
<p id="section-4.5-16">[Open issue: is an empty string (i.e., just a zero-value octet)
valid?]<a href="#section-4.5-16" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.5-17">
          <dt id="section-4.5-17.1">nrb_record_eui48 / nrb_record_eui64:</dt>
          <dd style="margin-left: 4.0em" id="section-4.5-17.2">
            <p id="section-4.5-17.2.1">The
nrb_record_eui48 / nrb_record_eui64 records specify an EUI (or MAC)
address (contained in the first 6 octets for eui48, 8 octets for eui64),
followed by one or more zero-terminated strings containing names resolved
for that address.  As above, the minimum valid Record Length is 8 for
EUI-48 and 10 for EUI-64.  There is no presumption implied in how these
names were acquired unless the DNS server options listed below are present
in the NRB.<a href="#section-4.5-17.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-18">Example: '02 ca ff ee f0 0d'"teapot under test".<a href="#section-4.5-18" class="pilcrow">¶</a></p>
<p id="section-4.5-19">[Open issue: is an empty string (i.e., just a zero-value octet)
valid?]<a href="#section-4.5-19" class="pilcrow">¶</a></p>
<p id="section-4.5-20">Record Types other than those specified earlier MUST be ignored and
skipped past. More Record Types will likely be defined in the future,
and MUST NOT break backwards compatibility.<a href="#section-4.5-20" class="pilcrow">¶</a></p>
<p id="section-4.5-21">Each Record Value is aligned to and padded to a 32-bit boundary.
The corresponding Record Value Length reflects the actual length of
the Record Value; it does not include the lengths of the Record Type
field, the Record Value Length field, any padding for the Record
Value, or anything after the Record Value. For Record Types with name
strings, the Record Length does include the zero-value octet
terminating that string. A Record Length of 0 is valid, unless
indicated otherwise.<a href="#section-4.5-21" class="pilcrow">¶</a></p>
<p id="section-4.5-22">After the list of Name Resolution Records, optionally, a list of
options (formatted according to the rules defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>) can be present.<a href="#section-4.5-22" class="pilcrow">¶</a></p>
<p id="section-4.5-23">In addition to the options defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>,
the following options are valid within this block:<a href="#section-4.5-23" class="pilcrow">¶</a></p>
<span id="name-name-resolution-block-optio"></span><div id="options_nrb">
<table class="center" id="table-7">
          <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-name-resolution-block-optio" class="selfRef">Name Resolution Block Options</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Multiple allowed?</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ns_dnsname</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">variable</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ns_dnsIP4addr</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ns_dnsIP6addr</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
          </tbody>
        </table>
</div>
<span class="break"></span><dl class="dlNewline" id="section-4.5-25">
          <dt id="section-4.5-25.1">ns_dnsname:</dt>
          <dd style="margin-left: 4.0em" id="section-4.5-25.2">
            <p id="section-4.5-25.2.1">The ns_dnsname
option is a UTF-8 string containing the name of the machine (DNS
server) used to perform the name resolution. The string is not
zero-terminated.<a href="#section-4.5-25.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-26">Example: "our_nameserver".<a href="#section-4.5-26" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.5-27">
          <dt id="section-4.5-27.1">ns_dnsIP4addr:</dt>
          <dd style="margin-left: 4.0em" id="section-4.5-27.2">
            <p id="section-4.5-27.2.1">The
ns_dnsIP4addr option specifies the IPv4 address of the DNS server.
Note that the IP address is treated as four octets, one for each
octet of the IP address; it is not a 32-bit word, and thus the
endianness of the SHB does not affect this field's value.<a href="#section-4.5-27.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-28">Example: '192 168 0 1'.<a href="#section-4.5-28" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.5-29">
          <dt id="section-4.5-29.1">ns_dnsIP6addr:</dt>
          <dd style="margin-left: 4.0em" id="section-4.5-29.2">
            <p id="section-4.5-29.2.1">The
ns_dnsIP6addr option specifies the IPv6 address of the DNS
server.<a href="#section-4.5-29.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.5-30">Example: '20 01 0d b8 00 00 00 00 00 00 00 00 12 34 56 78'.<a href="#section-4.5-30" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_isb">
<section id="section-4.6">
        <h3 id="name-interface-statistics-block">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-interface-statistics-block" class="section-name selfRef">Interface Statistics Block</a>
        </h3>
<p id="section-4.6-1">The Interface Statistics Block (ISB) contains the capture
statistics for a given interface and it is optional. The statistics
are referred to the interface defined in the current Section
identified by the Interface ID field. An Interface Statistics Block is
normally placed at the end of the file, but no assumptions can be
taken about its position - it can even appear multiple times for the
same interface.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">The format of the Interface Statistics Block is shown in <a href="#format_isb" class="auto internal xref">Figure 14</a>.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<span id="name-interface-statistics-block-"></span><div id="format_isb">
<figure id="figure-14">
          <div class="alignCenter art-text artwork" id="section-4.6-3.1">
<pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 0 |                   Block Type = 0x00000005                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |                         Interface ID                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |                       (Upper 32 bits)                         |
   + - - - - - - - - - - - -  Timestamp  - - - - - - - - - - - - - +
16 |                       (Lower 32 bits)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
20 /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-interface-statistics-block-" class="selfRef">Interface Statistics Block Format</a>
          </figcaption></figure>
</div>
<p id="section-4.6-4">The fields have the following meaning:<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-5.1">
            <p id="section-4.6-5.1.1">Block Type: The block type of the Interface Statistics Block is
5.<a href="#section-4.6-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-5.2">
            <p id="section-4.6-5.2.1">Block Total Length: total size of this block, as described in <a href="#section_block" class="auto internal xref">Section 3.1</a>.<a href="#section-4.6-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-5.3">
            <p id="section-4.6-5.3.1">Interface ID (32 bits): an unsigned value that specifies the
interface to which these statistics refer; the correct interface
will be the one whose Interface Description Block (within the current
Section of the file) is identified by the same number (see <a href="#section_idb" class="auto internal xref">Section 4.2</a>)
of this field. The interface ID MUST be valid, which means that an
matching interface description block MUST exist.<a href="#section-4.6-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-5.4">
            <p id="section-4.6-5.4.1">Timestamp (64 bits): the time at which the statistics values were
taken; two 32-bit unsigned values, in the same format as defined
for timestamps in the Enhanced Packet Block (<a href="#section_epb" class="auto internal xref">Section 4.3</a>),
using the 'if_tsresol' and 'if_tsoffset' values from the Interface
Description Block specified by the Interface ID.<a href="#section-4.6-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-5.5">
            <p id="section-4.6-5.5.1">Options: optionally, a list of options (formatted according to
the rules defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>) can be present.<a href="#section-4.6-5.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.6-6">All the statistics fields are defined as options in order to deal
with systems that do not have a complete set of statistics. Therefore,
In addition to the options defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>,
the following options are valid within this block:<a href="#section-4.6-6" class="pilcrow">¶</a></p>
<span id="name-interface-statistics-block-o"></span><div id="options_isb">
<table class="center" id="table-8">
          <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-interface-statistics-block-o" class="selfRef">Interface Statistics Block Options</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Multiple allowed?</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">isb_starttime</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">isb_endtime</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">isb_ifrecv</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">isb_ifdrop</td>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">isb_filteraccept</td>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">isb_osdrop</td>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">isb_usrdeliv</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">no</td>
            </tr>
          </tbody>
        </table>
</div>
<span class="break"></span><dl class="dlNewline" id="section-4.6-8">
          <dt id="section-4.6-8.1">isb_starttime:</dt>
          <dd style="margin-left: 4.0em" id="section-4.6-8.2">
            <p id="section-4.6-8.2.1">The isb_starttime
option specifies the time the capture started, consisting of two
unsigned 32-bit values, in the same format as defined for timestamps
in the Enhanced Packet Block (<a href="#section_epb" class="auto internal xref">Section 4.3</a>), using the 'if_tsresol'
and 'if_tsoffset' values from the Interface Description Block
specified by the Interface ID.<a href="#section-4.6-8.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.6-9">Example: '96 c3 04 00 73 89 6a 65', in Little Endian, decodes
to 2012-06-29 06:17:00.834163 UTC.<a href="#section-4.6-9" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.6-10">
          <dt id="section-4.6-10.1">isb_endtime:</dt>
          <dd style="margin-left: 4.0em" id="section-4.6-10.2">
            <p id="section-4.6-10.2.1">The isb_endtime
option specifies the time the capture ended, consisting of two
unsigned 32-bit values, in the same format as defined for timestamps
in the Enhanced Packet Block (<a href="#section_epb" class="auto internal xref">Section 4.3</a>), using the 'if_tsresol'
and 'if_tsoffset' values from the Interface Description Block
specified by the Interface ID.<a href="#section-4.6-10.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.6-11">Example: '97 c3 04 00 aa 47 ca 64', in Little Endian, decodes
to 2012-06-29 07:28:25.298858 UTC.<a href="#section-4.6-11" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.6-12">
          <dt id="section-4.6-12.1">isb_ifrecv:</dt>
          <dd style="margin-left: 4.0em" id="section-4.6-12.2">
            <p id="section-4.6-12.2.1">The isb_ifrecv
option specifies the 64-bit unsigned integer number of packets
that were received from the physical interface, starting at the
beginning of the capture.<a href="#section-4.6-12.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.6-13">Example: the decimal number 100.<a href="#section-4.6-13" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.6-14">
          <dt id="section-4.6-14.1">isb_ifdrop:</dt>
          <dd style="margin-left: 4.0em" id="section-4.6-14.2">
            <p id="section-4.6-14.2.1">The isb_ifdrop
option specifies the 64-bit unsigned integer number of packets
that were dropped by the interface due to lack of resources,
starting at the beginning of the capture.<a href="#section-4.6-14.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.6-15">Example: '0'.<a href="#section-4.6-15" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.6-16">
          <dt id="section-4.6-16.1">isb_filteraccept:</dt>
          <dd style="margin-left: 4.0em" id="section-4.6-16.2">
            <p id="section-4.6-16.2.1">The
isb_filteraccept option specifies the 64-bit unsigned integer
number of packets that were accepted by the filter, starting
from the beginning of the capture.<a href="#section-4.6-16.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.6-17">Example: the decimal number 100.<a href="#section-4.6-17" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.6-18">
          <dt id="section-4.6-18.1">isb_osdrop:</dt>
          <dd style="margin-left: 4.0em" id="section-4.6-18.2">
            <p id="section-4.6-18.2.1">The isb_osdrop
option specifies the 64-bit unsigned integer number of packets
that were dropped by the operating system, starting from the
beginning of the capture.<a href="#section-4.6-18.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.6-19">Example: '0'.<a href="#section-4.6-19" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.6-20">
          <dt id="section-4.6-20.1">isb_usrdeliv:</dt>
          <dd style="margin-left: 4.0em" id="section-4.6-20.2">
            <p id="section-4.6-20.2.1">The
isb_usrdeliv option specifies the 64-bit unsigned integer number
of packets that were delivered to the user, starting from the
beginning of the capture. The value contained in this field can
be different from the value 'isb_filteraccept - isb_osdrop'
because some packets could still be in the OS buffers when the
capture ended.<a href="#section-4.6-20.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.6-21">Example: '0'.<a href="#section-4.6-21" class="pilcrow">¶</a></p>
<p id="section-4.6-22">All the fields that refer to packet counters are 64-bit values,
represented with the octet order of the current section. Special care
must be taken in accessing these fields: since all the blocks are
aligned to a 32-bit boundary, such fields are not guaranteed to be
aligned on a 64-bit boundary.<a href="#section-4.6-22" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_dsb">
<section id="section-4.7">
        <h3 id="name-decryption-secrets-block">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-decryption-secrets-block" class="section-name selfRef">Decryption Secrets Block</a>
        </h3>
<p id="section-4.7-1">A Decryption Secrets Block (DSB) stores (session) secrets that
enable decryption of packets within the capture file. The format of
these secrets is defined by the Secrets Type.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">Multiple DSBs can exist in a pcapng file, but they SHOULD be written
before packet blocks that require those secrets. Tools MAY limit
decryption to secrets that appear before packet blocks.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">The structure of a
Decryption Secrets Block is shown in <a href="#format_dsb" class="auto internal xref">Figure 15</a>.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<span id="name-decryption-secrets-block-fo"></span><div id="format_dsb">
<figure id="figure-15">
          <div class="alignCenter art-text artwork" id="section-4.7-4.1">
<pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 0 |                   Block Type = 0x0000000A                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |                          Secrets Type                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |                         Secrets Length                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
16 /                                                               /
   /                          Secrets Data                         /
   /              (variable length, padded to 32 bits)             /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                                                               /
   /                       Options (variable)                      /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                       Block Total Length                      /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-decryption-secrets-block-fo" class="selfRef">Decryption Secrets Block Format</a>
          </figcaption></figure>
</div>
<p id="section-4.7-5">The Decryption Secrets Block has the following fields.<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-6.1">
            <p id="section-4.7-6.1.1">Block Type: The block type of the Decryption Secrets Block is
10.<a href="#section-4.7-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-6.2">
            <p id="section-4.7-6.2.1">Block Total Length: total size of this block, as described in <a href="#section_block" class="auto internal xref">Section 3.1</a>.<a href="#section-4.7-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-6.3">
            <p id="section-4.7-6.3.1">Secrets Type (32 bits): an unsigned integer identifier
that describes the format of the following Secrets field.
Requests for new Secrets Type codes should be made by creating
a pull request to update this document as described in
<a href="#section_block_code_registry" class="auto internal xref">Section 10.1</a>.<a href="#section-4.7-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-6.4">
            <p id="section-4.7-6.4.1">Secrets Length (32 bits): an unsigned integer that indicates
the size of the following Secrets field, without any padding
octets.<a href="#section-4.7-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-6.5">
            <p id="section-4.7-6.5.1">Secrets Data: binary data containing secrets, padded to a 32-bit
boundary.<a href="#section-4.7-6.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-6.6">
            <p id="section-4.7-6.6.1">Options: optionally, a list of options (formatted according to
the rules defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>) can be present.
No DSB-specific options are currently defined.<a href="#section-4.7-6.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.7-7">The following is a list of Secrets Types.<a href="#section-4.7-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.7-8">
          <dt id="section-4.7-8.1">0x544c534b:</dt>
          <dd style="margin-left: 4.0em" id="section-4.7-8.2">
            <p id="section-4.7-8.2.1">TLS Key Log. This
format is described at <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/Key_Log_Format">NSS Key Log Format</a>. Every line MUST be properly terminated with
either carriage return and linefeed ('\r\n') or linefeed ('\n').
Tools MUST be able to handle both line endings.<a href="#section-4.7-8.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-4.7-9">
          <dt id="section-4.7-9.1">0x55414b4c:</dt>
          <dd style="margin-left: 4.0em" id="section-4.7-9.2">
            <p id="section-4.7-9.2.1"><a href="https://opcfoundation.org/about/opc-technologies/opc-ua">OPC UA</a> Key Log.
Every line consists of a key/value pair separated by a colon and one space ('<code>: </code>').
Every line must be terminated by a linefeed ('<code>\n</code>').
The key name is composed of four parts separated by underscores ('<code>_</code>').<a href="#section-4.7-9.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-9.2.2.1">
                <p id="section-4.7-9.2.2.1.1">Keyset Name: Either 'server' or 'client'.<a href="#section-4.7-9.2.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.7-9.2.2.1.2">
The Client keys are used to secure Messages sent by the Client. The
  Server keys are used to secure Messages sent by the Server.<a href="#section-4.7-9.2.2.1.2" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.7-9.2.2.2">
                <p id="section-4.7-9.2.2.2.1">Key Material Type:<a href="#section-4.7-9.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-9.2.2.2.2.1">
                    <p id="section-4.7-9.2.2.2.2.1.1">'iv': initialization vector<a href="#section-4.7-9.2.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.7-9.2.2.2.2.2">
                    <p id="section-4.7-9.2.2.2.2.2.1">'key': AES key<a href="#section-4.7-9.2.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.7-9.2.2.2.2.3">
                    <p id="section-4.7-9.2.2.2.2.3.1">'siglen': signature length in octets. This depends on the used
security policy.<a href="#section-4.7-9.2.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-4.7-9.2.2.3">
                <p id="section-4.7-9.2.2.3.1">Secure Channel ID: Encoded as decimal value.<a href="#section-4.7-9.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.7-9.2.2.4">
                <p id="section-4.7-9.2.2.4.1">Token ID: Encoded as decimal value.<a href="#section-4.7-9.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.7-9.2.3">The <em>value</em> contains the key data encoded as hexadecimal string with upper
case letters.  To create a valid keyset, four entries for one combination of
secure channel ID and token ID are required. These entries include 'iv' and
'key' for both 'server' and 'client'.<a href="#section-4.7-9.2.3" class="pilcrow">¶</a></p>
<p id="section-4.7-9.2.4">Currently, AES-128-CBC and AES-256-CBC are supported encryption algorithms:<a href="#section-4.7-9.2.4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-9.2.5.1">
                <p id="section-4.7-9.2.5.1.1">AES-128-CBC:<a href="#section-4.7-9.2.5.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-9.2.5.1.2.1">
                    <p id="section-4.7-9.2.5.1.2.1.1">IV Length: 16 octets<a href="#section-4.7-9.2.5.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.7-9.2.5.1.2.2">
                    <p id="section-4.7-9.2.5.1.2.2.1">Key Length: 16 octets<a href="#section-4.7-9.2.5.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-4.7-9.2.5.2">
                <p id="section-4.7-9.2.5.2.1">AES-256-CBC:<a href="#section-4.7-9.2.5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-9.2.5.2.2.1">
                    <p id="section-4.7-9.2.5.2.2.1.1">IV Length: 16 octets<a href="#section-4.7-9.2.5.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.7-9.2.5.2.2.2">
                    <p id="section-4.7-9.2.5.2.2.2.1">Key Length: 32 octets<a href="#section-4.7-9.2.5.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<p id="section-4.7-9.2.6">More details on OPC UA Security can be found in the <a href="https://opcfoundation.org/developer-tools/documents/view/163">OPC UA Specification Part 6 - Mappings</a>,
 the security policies are defined in <a href="https://opcfoundation.org/developer-tools/documents/view/164">OPC UA Specification Part 7 - Profiles</a>,
 or can be found online on the <a href="https://opcfoundation.org/profilereporting">Profile Reporting website</a>.<a href="#section-4.7-9.2.6" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-9.3">0x57474b4c:</dt>
          <dd style="margin-left: 4.0em" id="section-4.7-9.4">
            <p id="section-4.7-9.4.1">WireGuard Key Log.
Every line consists of the key type, equals sign ('='), and the
base64-encoded 32-octet key with optional spaces before and in between.
The key type is one of LOCAL_STATIC_PRIVATE_KEY,
REMOTE_STATIC_PUBLIC_KEY, LOCAL_EPHEMERAL_PRIVATE_KEY,
or PRESHARED|_KEY. This matches the output of <a href="https://git.zx2c4.com/WireGuard/tree/contrib/examples/extract-handshakes/README">extract-handshakes.sh</a>, which is part of the <a href="https://www.wireguard.com/">WireGuard</a> project.
A PRESHARED_KEY line is linked to a session matched by a previous
LOCAL_EPHEMERAL_PRIVATE_KEY line.
Every line MUST be properly terminated with
either carriage return and linefeed ('\r\n') or linefeed ('\n').
Tools MUST be able to handle both line endings.<a href="#section-4.7-9.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.7-10">Warning: LOCAL_STATIC_PRIVATE_KEY and potentially PRESHARED_KEY
  are long-term secrets, users SHOULD only store non-production keys,
  or ensure proper protection of the pcapng file.<a href="#section-4.7-10" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.7-11">
          <dt id="section-4.7-11.1">0x5a4e574b:</dt>
          <dd style="margin-left: 4.0em" id="section-4.7-11.2">
            <p id="section-4.7-11.2.1">ZigBee NWK Key
and ZigBee PANID for that network. Network Key as described in
the <a href="https://zigbeealliance.org/">ZigBee Specification</a> 05-3473-21 (R21) section 4.2.2.
The NWK Key is a 16 octet binary AES-128 key used to secure NWK Level frames
within a single PAN. The NWK key is immediately followed by the
2-octet (16-bit) network PANID in little endian format. If and when
the NWK Key changes a new DSB will contain the new NWK Key.<a href="#section-4.7-11.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-4.7-12">
          <dt id="section-4.7-12.1">0x5a415053:</dt>
          <dd style="margin-left: 4.0em" id="section-4.7-12.2">
            <p id="section-4.7-12.2.1">ZigBee APS Key.
Application Support Link Key as described in the <a href="https://zigbeealliance.org/">ZigBee Specification</a> 05-3473-21 (R21) section 4.4. Each 16 octet binary AES-128 key secures
frames exchanged between a pair of network nodes. The APS Key is
immediately followed by the 2-octet (16-bit) network PANID in
little endian format. The PANID is followed by the 2-octet (16-bit)
short addresses, in little endian format, of the nodes to which
the APS Key applies. The numerically lower short address shall come
first. There is an APS Key DSB for each node pair for which the
Link Key is known. As new links are formed, new DSBs contain the
new Keys. If the APS Key changes for an existing link, it is
contained in a new DSB with the new APS Key.<a href="#section-4.7-12.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-zigbee-nwk-key-data-format"></span><div id="format_zigbee_nwk">
<figure id="figure-16">
          <div class="alignCenter art-text artwork" id="section-4.7-13.1">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------------------------------------------------------+
 0 |                   Block Type = 0x0000000A                     |
   +---------------------------------------------------------------+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |                  Secrets Type = 0x5a4e574b                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |                         Secrets Length                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
16 |                            AES-128                            |
   |                            NKW Key                            |
   |                          (16 octets)                          |
   |                           (128 bits)                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
32 |          PAN ID               |           padding (0)         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
36 /                                                               /
   /                       Options (variable)                      /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                       Block Total Length                      /
   +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-zigbee-nwk-key-data-format" class="selfRef">ZigBee NWK Key Data Format</a>
          </figcaption></figure>
</div>
<span id="name-zigbee-aps-key-data-format"></span><div id="format_zigbee_aps">
<figure id="figure-17">
          <div class="alignCenter art-text artwork" id="section-4.7-14.1">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------------------------------------------------------+
 0 |                   Block Type = 0x0000000A                     |
   +---------------------------------------------------------------+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |                  Secrets Type = 0x5a415053                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |                         Secrets Length                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
16 |                            AES-128                            |
   |                            APS Key                            |
   |                          (16 octets)                          |
   |                           (128 bits)                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
32 |           PAN ID              |     Low Node Short Address    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
36 |    High Node Short Address    |         padding (0)           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
40 /                                                               /
   /                       Options (variable)                      /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                       Block Total Length                      /
   +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-zigbee-aps-key-data-format" class="selfRef">ZigBee APS Key Data Format</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="section_custom_block">
<section id="section-4.8">
        <h3 id="name-custom-block">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-custom-block" class="section-name selfRef">Custom Block</a>
        </h3>
<p id="section-4.8-1">A Custom Block (CB) is the container for storing custom data that
is not part of another block; for storing custom data as part of
another block, see <a href="#section_custom_option" class="auto internal xref">Section 3.5.1</a>. The Custom
Block is optional, can be repeated any number of times, and can appear
before or after any other block except the first Section Header Block
which must come first in the file. Different Custom Blocks, of
different type codes and/or different Private Enterprise Numbers, may
be used in the same pcapng file. The format of a Custom Block is shown
in <a href="#format_custom_block" class="auto internal xref">Figure 18</a>.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<span id="name-custom-block-format"></span><div id="format_custom_block">
<figure id="figure-18">
          <div class="alignCenter art-text artwork" id="section-4.8-2.1">
<pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 0 |             Block Type = 0x00000BAD or 0x40000BAD             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |                Private Enterprise Number (PEN)                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 /                                                               /
   /                          Custom Data                          /
   /              variable length, padded to 32 bits               /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-custom-block-format" class="selfRef">Custom Block Format</a>
          </figcaption></figure>
</div>
<p id="section-4.8-3">The Custom Block uses the type code 0x00000BAD (2989 in decimal)
for a custom block that pcapng re-writers can copy into new files, and
the type code 0x40000BAD (1073744813 in decimal) for one that should
not be copied. See <a href="#section_vendor_copy" class="auto internal xref">Section 5.2</a> for details.<a href="#section-4.8-3" class="pilcrow">¶</a></p>
<p id="section-4.8-4">The Custom Block has the following fields:<a href="#section-4.8-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8-5.1">
            <p id="section-4.8-5.1.1">Block Type: The block type of the Custom Block is 0x00000BAD or
0x40000BAD, as described previously.<a href="#section-4.8-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.8-5.2">
            <p id="section-4.8-5.2.1">Block Total Length: total size of this block, as described in <a href="#section_block" class="auto internal xref">Section 3.1</a>.<a href="#section-4.8-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.8-5.3">
            <p id="section-4.8-5.3.1">Private Enterprise Number (32 bits): An IANA-assigned
Private Enterprise Number identifying the organization which
defined the Custom Block.  See <a href="#section_vendor_uses" class="auto internal xref">Section 5.1</a> for details.  The PEN MUST be
encoded using the same endianness as the Section Header
Block it is within the scope of.<a href="#section-4.8-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.8-5.4">
            <p id="section-4.8-5.4.1">Custom Data: the custom data, padded to a 32-bit boundary.<a href="#section-4.8-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.8-5.5">
            <p id="section-4.8-5.5.1">Options: optionally, a list of options (formatted according to
the rules defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>) can be present.
Note that custom options for the Custom Block still use the custom
option format and type code, as described in <a href="#section_custom_option" class="auto internal xref">Section 3.5.1</a>.<a href="#section-4.8-5.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="section_vendor">
<section id="section-5">
      <h2 id="name-vendor-specific-custom-exte">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-vendor-specific-custom-exte" class="section-name selfRef">Vendor-Specific Custom Extensions</a>
      </h2>
<p id="section-5-1">This section uses the term "vendor" to describe an organization which
extends the pcapng file with custom, proprietary blocks or options. It
should be noted, however, that the "vendor" is just an abstract entity
that agrees on a custom extension format: for example it may be a
manufacturer, industry association, an individual user, or collective
group of users.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="section_vendor_uses">
<section id="section-5.1">
        <h3 id="name-supported-use-cases">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-supported-use-cases" class="section-name selfRef">Supported Use-Cases</a>
        </h3>
<p id="section-5.1-1">There are two different supported use-cases for vendor-specific
custom extensions: local and portable. Local use means the custom data
is only expected to be usable on the same machine, and the same
application, which encoded it into the file. This limitation is due to
the lack of a common registry for the local use number codes (the
block or option type code numbers with the Most Significant Bit set).
Since two different vendors may choose the same number, one vendor's
application reading the other vendor's file would result in decoding
failure. Therefore, vendors SHOULD instead use the portable method, as
described next.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The portable use-case supports vendor-specific custom extensions in
pcapng files which can be shared across systems, organizations, etc.
To avoid number space collisions, an IANA-registered Private
Enterprise Number (PEN) is encoded into the Custom Block or Custom
Option, using the PEN that belongs to the vendor defining the
extension. Anyone can register a new PEN with IANA, for free, by
filling out the online request form at <a href="http://pen.iana.org/pen/PenApplication.page">http://pen.iana.org/pen/PenApplication.page</a>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_vendor_copy">
<section id="section-5.2">
        <h3 id="name-controlling-copy-behavior">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-controlling-copy-behavior" class="section-name selfRef">Controlling Copy Behavior</a>
        </h3>
<p id="section-5.2-1">Both Custom Blocks and Custom Options support two different type codes
to distinguish their "copy" behavior: a type code for when the block or
option can be safely copied into a new pcapng file by a pcapng
manipulating application, and a type code for when it should not be
copied. A common reason for not copying a Custom Block or Custom Option
is because it depends on other blocks or options in some way that would
invalidate the custom data if the other blocks/options were removed or
re-ordered. For example, if a Custom Block's data includes an
Interface ID number in its Custom Data portion, then it cannot be
safely copied by a pcapng application that merges pcapng files,
because the merging application might re-order or remove one or more
of the Interface Description Blocks, and thereby change the Interface
IDs that the Custom Block depends upon. The same issue arises if a
Custom Block or Custom Option depends on the presence of, or specific
ordering of, other standard-based or custom-defined blocks or
options.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Note that the copy semantics is not related to privacy - there is
no guarantee that a pcapng anonymizer will remove a Custom Block or
Custom Option, even if the appropriate type code is used requesting it
not be copied; and the original pcapng file can be shared anyway. If the
Custom Data portion of the Custom Block or Custom Option contains
sensitive information, then it should be encrypted in some
fashion.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_vendor_strings">
<section id="section-5.3">
        <h3 id="name-strings-vs-octets">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-strings-vs-octets" class="section-name selfRef">Strings vs. Octets</a>
        </h3>
<p id="section-5.3-1">For the Custom Options, there are two Custom Data formats
supported: a UTF-8 string and a binary data payload. The rationale for
this separation is that a pcapng display application which does not
understand the specific PEN's Custom Option can still display the data
as a string if it's a string type code, rather than as hex-ascii of
the octets.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_vendor_endian">
<section id="section-5.4">
        <h3 id="name-endianness-issues">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-endianness-issues" class="section-name selfRef">Endianness Issues</a>
        </h3>
<p id="section-5.4-1">Implementers writing Custom Blocks or binary data Custom Options should
be aware that a pcapng file can be re-written by machines using a
different endianness than the original file, which means all known
fields of the pcapng file will change endianness in the new file.  Since
the Custom Data payload of the Custom Block or the binary data Custom
Option might be an arbitrary sequence of unknown octets to such
machines, they cannot convert multi-octet values inside the Custom Data,
or in the Options  section of a Custom Block,into the appropriate
endianness.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">For example, a little-endian machine can create a new pcapng file and
add some binary data Custom Options to some non-Custom Block(s) in the
file.  This file can then be sent to a big-endian host, which will
convert the Option Type, Option Length, and PEN fields of the options to
big-endian format if it re-writes the file.  However, if the software
reading the file does not understand the contents of all of the Custom
Options, it will leave the Custom Data payload of the options alone (as
little-endian format).  If this file then gets sent to a little-endian
machine, then, when that little-endian machine reads the file, it will,
if the software reading the file understands the contents of all the
Custom Options, it will detect that the file format is big-endian, and
swap the endianness while it parses the file - but that will cause the
Custom Data payload to be incorrect since it was already in
little-endian format.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">In addition, a little-endian machine can create a pcapng file and write
some binary data Custom Blocks, containing options, to the file.  The
file can then be sent to a big-endian host, which, if the software
reading the file does not understand the contents of the Custom Blocks,
will leave the Custom Data and Options alone (as little-endian format).
If this file then gets sent to a little-endian machine, then, when that
little-endian machine reads the file, it will, if the software reading
the file understands the contents of all the Custom Blocks, it will
detect that the file format is big-endian, and swap the endianness while
it parses the file - but that will cause the Custom Data payload, the
Option Type and Option Length values in the Options, and the PEN in any
Custom Options to be incorrect since they were already in little-endian
format.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">Therefore, the vendor should either encode the Custom Data of their
Custom Blocks and Custom Options, the Option Type and Option Length
fields of options in Custom Blocks, and the PEN field of Custom Options
in Custom Blocks in a consistent manner, such as always in big-endian or
always in little-endian format, regardless of the host platform's
endianness, or should encode some flag in the Custom Data payload to
indicate in which endianness the rest of the payload is written.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<p id="section-5.4-5">The PEN field of a Custom Block, or of a Custom Option not contained in
a Custom Block, MUST be converted by code that reads pcapng files, so
this is not an issue for that field, except for Custom Options in Custom
Blocks.  This is also not an issue for the Custom Data payload of UTF-8
string Custom Options.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="recommended-file-name-extension-pcapng">
<section id="section-6">
      <h2 id="name-recommended-file-name-exten">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-recommended-file-name-exten" class="section-name selfRef">Recommended File Name Extension: .pcapng</a>
      </h2>
<p id="section-6-1">The recommended file name extension for the "PCAP Next Generation
Capture File Format" specified in this document is ".pcapng".<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">On Windows and macOS, files are distinguished by an extension to their
filename. Such an extension is technically not actually required, as
applications should be able to automatically detect the pcapng file
format through the Block Type and Byte-Order Magic fields in the Section
Header Block at the beginning of the file, as some desktop environments
other than those of Windows and macOS do. However, using name
extensions makes it easier to work with files (e.g. visually
distinguish file formats) so it is recommended - though not required -
to use .pcapng as the name extension for files following this
specification.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Please note: To avoid confusion (such as the current usage of
.cap for a plethora of different capture file formats) file
name extensions other than .pcapng should be avoided.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conclusions">
<section id="section-7">
      <h2 id="name-conclusions">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-conclusions" class="section-name selfRef">Conclusions</a>
      </h2>
<p id="section-7-1">The file format proposed in this document should be very versatile
and satisfy a wide range of applications. In the simplest case, it can
contain a raw capture of the network data, made of a series of Simple
Packet Blocks. In the most complex case, it can be used as a repository
for heterogeneous information. In every case, the file remains easy to
parse and an application can always skip the data it is not interested
in; at the same time, different applications can share the file, and
each of them can benefit of the information produced by the others. Two
or more files can be concatenated obtaining another valid file.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementations">
<section id="section-8">
      <h2 id="name-implementations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-implementations" class="section-name selfRef">Implementations</a>
      </h2>
<p id="section-8-1">Some known implementations that read or write the pcapng file format
are listed on the <a href="https://github.com/IETF-OPSAWG-WG/pcapng/wiki/Implementations">pcapng GitHub wiki</a>.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">TBD.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">TBD.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">[Open issue: decide whether the block types, option types, NRB Record
types, etc. should be IANA registries. And if so, what the IANA policy
for each should be (see RFC 5226)]<a href="#section-10-2" class="pilcrow">¶</a></p>
<div id="section_block_code_registry">
<section id="section-10.1">
        <h3 id="name-standardized-block-type-cod">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-standardized-block-type-cod" class="section-name selfRef">Standardized Block Type Codes</a>
        </h3>
<p id="section-10.1-1">Every Block is uniquely identified by a 32-bit integer value, stored
in the Block Header.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">As pointed out in <a href="#section_block" class="auto internal xref">Section 3.1</a>, Block Type
codes whose Most Significant Bit (bit 31) is set to 1 are reserved for
local use by the application.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1-3">All the remaining Block Type codes (0x00000000 to 0x7FFFFFFF) are
standardized by this document. Requests for new Block Type codes,
Option Type codes, and Secrets Type codes should be made by creating
a pull request to update this document at <a href="https://github.com/IETF-OPSAWG-WG/pcapng">github.com/IETF-OPSAWG-WG/pcapng</a>.
The pull request should add a description of the new block, option,
or secret type to <a href="#section_block_definition" class="auto internal xref">Section 4</a>. The pull request
description should contain a clear request for a new type code
assignment.<a href="#section-10.1-3" class="pilcrow">¶</a></p>
<p id="section-10.1-4">The following is a list of the Standardized Block Type Codes:<a href="#section-10.1-4" class="pilcrow">¶</a></p>
<span id="name-standardized-block-type-code"></span><div id="blockcodes">
<table class="center" id="table-9">
          <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-standardized-block-type-code" class="selfRef">Standardized Block Type Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Block Type Code</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000000</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved ???</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000001</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#section_idb" class="internal xref">Interface Description Block</a> (<a href="#section_idb" class="auto internal xref">Section 4.2</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000002</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#appendix_pb" class="internal xref">Packet Block</a> (<a href="#appendix_pb" class="auto internal xref">Appendix A</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000003</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#section_spb" class="internal xref">Simple Packet Block</a> (<a href="#section_spb" class="auto internal xref">Section 4.4</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000004</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#section_nrb" class="internal xref">Name Resolution Block</a> (<a href="#section_nrb" class="auto internal xref">Section 4.5</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000005</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#section_isb" class="internal xref">Interface Statistics Block</a> (<a href="#section_isb" class="auto internal xref">Section 4.6</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000006</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#section_epb" class="internal xref">Enhanced Packet Block</a> (<a href="#section_epb" class="auto internal xref">Section 4.3</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000007</td>
              <td class="text-left" rowspan="1" colspan="1">IRIG Timestamp Block (requested by Gianluca Varenni &lt;gianluca.varenni@cacetech.com&gt;, CACE Technologies LLC); code also used for <a href="https://github.com/google/linux-sensor/blob/master/hone-pcapng.txt">Socket Aggregation Event Block</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000008</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://en.wikipedia.org/wiki/ARINC_429">ARINC 429</a> in AFDX Encapsulation Information Block (requested by Gianluca Varenni &lt;gianluca.varenni@cacetech.com&gt;, CACE Technologies LLC)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000009</td>
              <td class="text-left" rowspan="1" colspan="1">[systemd Journal Export Block]<span>[<a href="#I-D.richardson-opsawg-pcapng-extras" class="cite xref">I-D.richardson-opsawg-pcapng-extras</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0000000A</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#section_dsb" class="internal xref">Decryption Secrets Block</a> (<a href="#section_dsb" class="auto internal xref">Section 4.7</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000101</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/HoneProject">Hone Project</a> <a href="https://github.com/HoneProject/Linux-Sensor/wiki/Augmented-PCAP-Next-Generation-Dump-File-Format">Machine Info Block</a> (see also <a href="https://github.com/google/linux-sensor/blob/master/hone-pcapng.txt">Google version</a>)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000102</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/HoneProject">Hone Project</a> <a href="https://github.com/HoneProject/Linux-Sensor/wiki/Augmented-PCAP-Next-Generation-Dump-File-Format">Connection Event Block</a> (see also <a href="https://github.com/google/linux-sensor/blob/master/hone-pcapng.txt">Google version</a>)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000201</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> Machine Info Block</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000202</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> Process Info Block, version 1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000203</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> FD List Block</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000204</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> Event Block</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000205</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> Interface List Block</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000206</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> User List Block</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000207</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> Process Info Block, version 2</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000208</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> Event Block with flags</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000209</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> Process Info Block, version 3</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000210</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> Process Info Block, version 4</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000211</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> Process Info Block, version 5</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000212</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> Process Info Block, version 6</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000213</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://github.com/draios/sysdig">Sysdig</a> Process Info Block, version 7</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00000BAD</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#section_custom_block" class="internal xref">Custom Block that rewriters can copy into new files</a> (<a href="#section_custom_block" class="auto internal xref">Section 4.8</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x40000BAD</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#section_custom_block" class="internal xref">Custom Block that rewriters should not copy into new files</a> (<a href="#section_custom_block" class="auto internal xref">Section 4.8</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0A0D0D0A</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#section_shb" class="internal xref">Section Header Block</a> (<a href="#section_shb" class="auto internal xref">Section 4.1</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0A0D0A00-0x0A0D0AFF</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved. Used to detect trace files corrupted because of file transfers using the HTTP protocol in text mode.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x000A0D0A-0xFF0A0D0A</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved. Used to detect trace files corrupted because of file transfers using the HTTP protocol in text mode.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x000A0D0D-0xFF0A0D0D</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved. Used to detect trace files corrupted because of file transfers using the HTTP protocol in text mode.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0D0D0A00-0x0D0D0AFF</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved. Used to detect trace files corrupted because of file transfers using the FTP protocol in text mode.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x80000000-0xFFFFFFFF</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved for local use.</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-10.1-6">[Open issue: reserve 0x40000000-0x7FFFFFFF for do-not-copy-bit
range of base types?]<a href="#section-10.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="contributors">
<section id="section-11">
      <h2 id="name-contributors">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-11-1">Loris Degioanni and Gianluca Varenni were coauthoring this document
before it was submitted to the IETF.<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="section-12">
      <h2 id="name-acknowledgments">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-12-1">The authors wish to thank
Anders Broman,
Ulf Lamping,
Richard Sharpe
and many others for their invaluable comments.<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.richardson-opsawg-pcaplinktype">[I-D.richardson-opsawg-pcaplinktype]</dt>
        <dd>
<span class="refAuthor">Harris, G.</span> and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"PCAP and PCAPNG LINKTYPE Registry"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-richardson-opsawg-pcaplinktype-01</span>, <time datetime="2022-11-06" class="refDate">6 November 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-richardson-opsawg-pcaplinktype-01">https://datatracker.ietf.org/doc/html/draft-richardson-opsawg-pcaplinktype-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.richardson-opsawg-pcapng-extras">[I-D.richardson-opsawg-pcapng-extras]</dt>
      <dd>
<span class="refAuthor">Tüxen, M.</span>, <span class="refAuthor">Risso, F.</span>, <span class="refAuthor">Bongertz, J.</span>, <span class="refAuthor">Combs, G.</span>, <span class="refAuthor">Harris, G.</span>, <span class="refAuthor">Chaudron, E.</span>, and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"Additional block types for PCAP Next Generation (pcapng) Capture File Format"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-richardson-opsawg-pcapng-extras-01</span>, <time datetime="2022-07-29" class="refDate">29 July 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-richardson-opsawg-pcapng-extras-01">https://datatracker.ietf.org/doc/html/draft-richardson-opsawg-pcapng-extras-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="appendix_pb">
<section id="appendix-A">
      <h2 id="name-packet-block-obsolete">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-packet-block-obsolete" class="section-name selfRef">Packet Block (obsolete!)</a>
      </h2>
<p id="appendix-A-1">The Packet Block is obsolete, and MUST NOT be used in new files. Use
the Enhanced Packet Block or Simple Packet Block instead. This section
is for historical reference only.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">A Packet Block was a container for storing packets coming from the
network.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<span id="name-packet-block-format"></span><div id="formatpb">
<figure id="figure-19">
        <div class="alignCenter art-text artwork" id="appendix-A-3.1">
<pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 0 |                    Block Type = 0x00000002                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 4 |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 8 |         Interface ID          |          Drops Count          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
12 |                       (Upper 32 bits)                         |
   + - - - - - - - - - - - -  Timestamp  - - - - - - - - - - - - - +
16 |                       (Lower 32 bits)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
20 |                    Captured Packet Length                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
24 |                    Original Packet Length                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
28 /                                                               /
   /                          Packet Data                          /
   /              variable length, padded to 32 bits               /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                                                               /
   /                      Options (variable)                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-packet-block-format" class="selfRef">Packet Block Format</a>
        </figcaption></figure>
</div>
<p id="appendix-A-4">The Packet Block has the following fields:<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-5.1">
          <p id="appendix-A-5.1.1">Block Type: The block type of the Packet Block is 2.<a href="#appendix-A-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.2">
          <p id="appendix-A-5.2.1">Block Total Length: total size of this block, as described in <a href="#section_block" class="auto internal xref">Section 3.1</a>.<a href="#appendix-A-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.3">
          <p id="appendix-A-5.3.1">Interface ID: specifies the interface this packet comes from;
the correct interface will be the one whose Interface Description
Block (within the current Section of the file) is identified by the
same number (see <a href="#section_idb" class="auto internal xref">Section 4.2</a>) of this field. The
interface ID MUST be valid, which means that an matching interface
description block MUST exist.<a href="#appendix-A-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.4">
          <p id="appendix-A-5.4.1">Drops Count: a local drop counter. It specifies the number of
packets lost (by the interface and the operating system) between
this packet and the preceding one. The value xFFFF (in hexadecimal)
is reserved for those systems in which this information is not
available.<a href="#appendix-A-5.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.5">
          <p id="appendix-A-5.5.1">Timestamp (64 bits): two 32-bit unsigned values, in the same format
as defined for timestamps in the Enhanced Packet Block (<a href="#section_epb" class="auto internal xref">Section 4.3</a>),
using the 'if_tsresol' and 'if_tsoffset' values from the Interface
Description Block specified by the Interface ID.<a href="#appendix-A-5.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.6">
          <p id="appendix-A-5.6.1">Captured Packet Length: number of octets captured from the
packet (i.e. the length of the Packet Data field). It will be the
minimum value among the Original Packet Length and the
snapshot length for the interface (SnapLen, defined in <a href="#format_idb" class="auto internal xref">Figure 10</a>). The value of this field does
not include the padding octets added at the end of the Packet
Data field to align the Packet Data field to a 32-bit
boundary.<a href="#appendix-A-5.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.7">
          <p id="appendix-A-5.7.1">Original Packet Length: actual length of the packet when it was
transmitted on the network. It can be different from Captured Packet
Length if the packet has been truncated by the capture process.<a href="#appendix-A-5.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.8">
          <p id="appendix-A-5.8.1">Packet Data: the data coming from the network, including
link-layer headers. The actual length of this field is
Captured Packet Length plus the padding to a 32-bit
boundary. The format of the link-layer headers depends on
the LinkType field specified in the Interface Description
Block (see <a href="#section_idb" class="auto internal xref">Section 4.2</a>) and it is specified
in the entry for that format in <span>[<a href="#I-D.richardson-opsawg-pcaplinktype" class="cite xref">I-D.richardson-opsawg-pcaplinktype</a>]</span>.<a href="#appendix-A-5.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.9">
          <p id="appendix-A-5.9.1">Options: optionally, a list of options (formatted according to
the rules defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>) can be present.<a href="#appendix-A-5.9.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-6">In addition to the options defined in <a href="#section_opt" class="auto internal xref">Section 3.5</a>,
the following options were valid within this block:<a href="#appendix-A-6" class="pilcrow">¶</a></p>
<span id="name-packet-block-options"></span><div id="optionspb">
<table class="center" id="table-10">
        <caption>
<a href="#table-10" class="selfRef">Table 10</a>:
<a href="#name-packet-block-options" class="selfRef">Packet Block Options</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Type</th>
            <th class="text-left" rowspan="1" colspan="1">Length</th>
            <th class="text-left" rowspan="1" colspan="1">Multiple allowed?</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">pack_flags</td>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">no</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">pack_hash</td>
            <td class="text-left" rowspan="1" colspan="1">3</td>
            <td class="text-left" rowspan="1" colspan="1">variable</td>
            <td class="text-left" rowspan="1" colspan="1">yes</td>
          </tr>
        </tbody>
      </table>
</div>
<span class="break"></span><dl class="dlNewline" id="appendix-A-8">
        <dt id="appendix-A-8.1">pack_flags:</dt>
        <dd style="margin-left: 4.0em" id="appendix-A-8.2">
          <p id="appendix-A-8.2.1">The pack_flags
option is the same as the epb_flags of the enhanced packet
block.<a href="#appendix-A-8.2.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="appendix-A-9">Example: '0'.<a href="#appendix-A-9" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="appendix-A-10">
        <dt id="appendix-A-10.1">pack_hash:</dt>
        <dd style="margin-left: 4.0em" id="appendix-A-10.2">
          <p id="appendix-A-10.2.1">The pack_hash
option is the same as the epb_hash of the enhanced packet block.<a href="#appendix-A-10.2.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="appendix-A-11">Examples: '02 EC 1D 87 97', '03 45 6E C2 17 7C 10 1E 3C 2E 99 6E
C2 9A 3D 50 8E'.<a href="#appendix-A-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Tuexen (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Muenster University of Applied Sciences</span></div>
<div dir="auto" class="left"><span class="street-address">Stegerwaldstrasse 39</span></div>
<div dir="auto" class="left">
<span class="postal-code">48565</span> <span class="locality">Steinfurt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tuexen@fh-muenster.de" class="email">tuexen@fh-muenster.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Fulvio Risso</span></div>
<div dir="auto" class="left"><span class="org">Politecnico di Torino</span></div>
<div dir="auto" class="left"><span class="street-address">Corso Duca degli Abruzzi, 24</span></div>
<div dir="auto" class="left">
<span class="postal-code">10129</span> <span class="locality">Torino</span> </div>
<div dir="auto" class="left"><span class="country-name">Italy</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fulvio.risso@polito.it" class="email">fulvio.risso@polito.it</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jasper Bongertz</span></div>
<div dir="auto" class="left"><span class="org">Airbus Defence and Space CyberSecurity</span></div>
<div dir="auto" class="left"><span class="street-address">Kanzlei 63c</span></div>
<div dir="auto" class="left">
<span class="postal-code">40667</span> <span class="locality">Meerbusch</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jasper@packet-foo.com" class="email">jasper@packet-foo.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Gerald Combs</span></div>
<div dir="auto" class="left"><span class="org">Wireshark Foundation</span></div>
<div dir="auto" class="left"><span class="street-address">339 Madson Pl</span></div>
<div dir="auto" class="left">
<span class="locality">Davis</span>, <span class="region">CA</span> <span class="postal-code">95618</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gerald@wireshark.org" class="email">gerald@wireshark.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Guy Harris</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gharris@sonic.net" class="email">gharris@sonic.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Eelco Chaudron</span></div>
<div dir="auto" class="left"><span class="org">Red Hat</span></div>
<div dir="auto" class="left"><span class="street-address">De Entree 238</span></div>
<div dir="auto" class="left">
<span class="postal-code">1101 EE</span> <span class="locality">Amsterdam</span>
</div>
<div dir="auto" class="left"><span class="country-name">Netherlands</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:eelco@redhat.com" class="email">eelco@redhat.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael C. Richardson</span></div>
<div dir="auto" class="left"><span class="org">Sandelman Software Works</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mcr+ietf@sandelman.ca" class="email">mcr+ietf@sandelman.ca</a>
</div>
<div class="url">
<span>URI:</span>
<a href="http://www.sandelman.ca/" class="url">http://www.sandelman.ca/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
